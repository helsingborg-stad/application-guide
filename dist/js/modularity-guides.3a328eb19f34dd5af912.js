!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([,function(e,t,n){"use strict";n.r(t);(function(e){function t(t){var n,o;t.preventDefault();var r=t.target,i=r.closest(".js-modularity-guide-todos"),a=null==r||null===(n=r.querySelector('textarea[name="g-recaptcha-response"]'))||void 0===n?void 0:n.val(),u=null==r||null===(o=r.querySelector('input[name="email"]'))||void 0===o?void 0:o.value;if(""===a)return!1;var l=null==i?void 0:i.querySelector(".js-modularity-guide-todos__table");if(l&&u&&ajaxurl){var c={action:"email_todo",checklist:function(e){var t,n,o=e.cloneNode(!0);null===(t=o=document.body.appendChild(o))||void 0===t||null===(n=t.querySelectorAll("tr"))||void 0===n||n.forEach((function(e){var t;(t=e).offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0||e.remove()}));var r=o.outerHTML;return o.remove(),encodeURI(r)}(l),email:u,captcha:a};e.post(ajaxurl,c,(function(e){"success"==e?console.log("success!"):console.log("fails!"),location.hash=""}))}}window.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".js-modularity-guide-todos");(null==e?void 0:e.length)>0&&e.forEach((function(e){var n=null==e?void 0:e.querySelector(".js-modularity-guide-todos__form");n&&n.addEventListener("submit",t)}))}))})(jQuery),function(e){function t(){this.handleEvents(),this.contentToggleEngine()}t.prototype.handleEvents=function(){e('input[type="checkbox"][data-mod-guide-relation]').on("change",(function(t){var n=e(this).data("mod-guide-relation");n=n.split(","),e.each(n,(function(t,n){var o=e('input[type="checkbox"][data-mod-guide-toggle-key="'+n+'"]');o.prop("checked",!o.prop("checked")).trigger("change")}))})),e("[data-mod-guide-toggle-key]").on("change",function(e){this.contentToggleEngine()}.bind(this))},t.prototype.contentToggleEngine=function(){var t=[];e("[data-mod-guide-toggle-key]").each((function(n,o){!0===e(o).prop("checked")&&t.push(e(o).attr("data-mod-guide-toggle-key"))})),e("[data-mod-guide-toggle-key-content]").each((function(n,o){var r=!1,i=e(o).attr("data-mod-guide-toggle-key-content");i=i.split(","),e.each(i,(function(e,n){var o=n.match(/(^|\+)([^\+\-]+)/g),i=new RegExp("\\b("+o.join("|").replace("+","")+")\\b","ig"),a=t.join(",").match(i),u=null!==a&&a.length===o.length,l=n.match(/\-([^\+\-]+)/g),c=!0;if(null!==l){var d=new RegExp("\\b("+l.join("|").replace("-","")+")\\b","ig"),s=t.join(",").match(d);c=!(null!==s&&s.length>0)}u&&c&&(r=!0)})),!0!==r?e(o).hide():e(o).show()}))},new t}(jQuery);function o(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function i(e){var t;e.preventDefault();var n=e.target,o=e.target.classList.contains(".js-modularity-guide__next".substring(1)),r=null==n?void 0:n.closest(".js-modularity-guide"),i=null==n?void 0:n.closest(".js-modularity-guide__section"),a=parseInt(null!==(t=null==i?void 0:i.getAttribute("data-guide-step"))&&void 0!==t?t:"-1");if(a>0){var u=o?a+1:a-1,l=null==r?void 0:r.querySelector("[".concat("data-guide-step",'="').concat(u,'"]')),c=null==l?void 0:l.querySelector("[js-expand-button]");c&&c.click()}}function a(e){var t=[].concat(o(e.querySelectorAll("".concat(".js-modularity-guide__section"," ").concat(".js-modularity-guide__next"))),o(e.querySelectorAll("".concat(".js-modularity-guide__section"," ").concat(".js-modularity-guide__prev"))));t.length>0&&t.forEach((function(e){e.addEventListener("click",i)}))}window.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".js-modularity-guide");e&&e.length>0&&e.forEach(a)}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL0NvbnRlbnQvVG9kby5qcyIsIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvQ29udGVudC9jaGVja2JveGVzLmpzIiwid2VicGFjazovLy8uL3NvdXJjZS9qcy9tb2R1bGFyaXR5LWd1aWRlcy5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIiQiLCJoYW5kbGVTdWJtaXQiLCJlIiwicHJldmVudERlZmF1bHQiLCJjdXJyZW50Rm9ybSIsInRhcmdldCIsImN1cnJlbnRTZWN0aW9uIiwiY2xvc2VzdCIsInJlY2FwdGNoYSIsInF1ZXJ5U2VsZWN0b3IiLCJ2YWwiLCJlbWFpbCIsInRvZG9UYWJsZSIsImFqYXh1cmwiLCJkYXRhIiwiYWN0aW9uIiwiY2hlY2tsaXN0IiwiY2xvbmVOb2RlIiwiZG9jdW1lbnQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsInJvdyIsImVsZW0iLCJvZmZzZXRXaWR0aCIsIm9mZnNldEhlaWdodCIsImdldENsaWVudFJlY3RzIiwibGVuZ3RoIiwicmVtb3ZlIiwiY2hlY2tsaXN0SFRNTCIsIm91dGVySFRNTCIsImVuY29kZVVSSSIsImdldENoZWNrTGlzdCIsImNhcHRjaGEiLCJwb3N0IiwicmVzcG9uc2UiLCJjb25zb2xlIiwibG9nIiwibG9jYXRpb24iLCJoYXNoIiwid2luZG93IiwiYWRkRXZlbnRMaXN0ZW5lciIsInRvZG9TZWN0aW9ucyIsInRvZG9TZWN0aW9uIiwiZm9ybSIsImpRdWVyeSIsIkNoZWNrYm94ZXMiLCJ0aGlzIiwiaGFuZGxlRXZlbnRzIiwiY29udGVudFRvZ2dsZUVuZ2luZSIsIm9uIiwicmVsYXRpb25zIiwic3BsaXQiLCJlYWNoIiwiaW5kZXgiLCJpdGVtIiwiJGNiIiwicHJvcCIsInRyaWdnZXIiLCJjaGVja2VkIiwiZWxlbWVudCIsInB1c2giLCJhdHRyIiwic2hvdWxkU2hvdyIsImNvbmRpdGlvbnMiLCJhbmQiLCJtYXRjaCIsImFuZFBhdHRlcm4iLCJSZWdFeHAiLCJqb2luIiwicmVwbGFjZSIsImFuZE1hdGNoZXMiLCJhbmRJc01hdGNoaW5nIiwiYW5kbm90IiwiYW5kbm90SXNNYXRjaGluZyIsImFuZG5vdFBhdHRlcm4iLCJhbmRub3RNYXRjaGVzIiwiaGlkZSIsInNob3ciLCJoYW5kbGVQcmV2TmV4dENsaWNrIiwicHJldk5leHRCdXR0b25FbGVtZW50IiwiaXNOZXh0IiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJzdWJzdHJpbmciLCJjdXJyZW50R3VpZGUiLCJjdXJyZW50U3RlcCIsInBhcnNlSW50IiwiZ2V0QXR0cmlidXRlIiwidGFyZ2V0U3RlcCIsInRhcmdldFNlY3Rpb24iLCJ0YXJnZXRUb2dnbGUiLCJjbGljayIsInN1YnNjcmliZVByZXZOZXh0QnV0dG9ucyIsIndyYXBwZXJFbGVtZW50IiwiYnV0dG9ucyIsImJ1dHRvbkVsZW1lbnQiLCJndWlkZU1vZHVsZXMiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFH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RixFQUFuRCxPQUNoQkUsRUFBZUQsYUFBSCxFQUFHQSxFQUFlbEYsY0F4QlYsc0JBMEJ0Qm1GLEdBQ0FBLEVBQWFDLFNBU3pCLFNBQVNDLEVBQXlCQyxHQUM5QixJQUFNQyxFQUFVLEdBQUgsU0FDTkQsRUFBZTFFLGlCQUFmLFVBekNjLGdDQXlDZCxZQXhDVyxnQ0F1Q0wsRUFFTjBFLEVBQWUxRSxpQkFBZixVQTFDYyxnQ0EwQ2QsWUF4Q1csaUNBMkNkMkUsRUFBUXBFLE9BQVMsR0FDakJvRSxFQUFRMUUsU0FBUSxTQUFBMkUsR0FDWkEsRUFBY3ZELGlCQUFpQixRQUFTc0MsTUFnQnBEdkMsT0FBT0MsaUJBQWlCLG9CQVJ4QixXQUNJLElBQU13RCxFQUFlaEYsU0FBU0csaUJBekRBLHdCQTJEMUI2RSxHQUFnQkEsRUFBYXRFLE9BQVMsR0FDdENzRSxFQUFhNUUsUUFBUXdFIiwiZmlsZSI6ImpzL21vZHVsYXJpdHktZ3VpZGVzLjNhMzI4ZWIxOWYzNGRkNWFmOTEyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiY29uc3QgU0VMRUNUT1JfVE9ET1NfV1JBUFBFUiA9ICcuanMtbW9kdWxhcml0eS1ndWlkZS10b2Rvcyc7XG5jb25zdCBTRUxFQ1RPUl9GT1JNID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlLXRvZG9zX19mb3JtJztcbmNvbnN0IFNFTEVDVE9SX1RBQkxFID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlLXRvZG9zX190YWJsZSc7XG5jb25zdCBTRUxFQ1RPUl9JTlBVVF9SRUNBUFRDSEEgPSAndGV4dGFyZWFbbmFtZT1cImctcmVjYXB0Y2hhLXJlc3BvbnNlXCJdJztcbmNvbnN0IFNFTEVDVE9SX0lOUFVUX0VNQUlMID0gJ2lucHV0W25hbWU9XCJlbWFpbFwiXSc7XG5cbmV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiAoJCkge1xuICAgIC8qKlxuICAgICAqIENoZWNrIGlmIGVsZW1lbnQgaXMgdmlzaWJsZSBvciBub3RcbiAgICAgKiBAcGFyYW0geyp9IGVsZW0gXG4gICAgICogQHJldHVybnMge2Jvb2xlYW59XG4gICAgICovXG4gICAgY29uc3QgaXNWaXNpYmxlID0gKGVsZW0pID0+IChlbGVtLm9mZnNldFdpZHRoID4gMCB8fCBlbGVtLm9mZnNldEhlaWdodCA+IDAgfHwgZWxlbS5nZXRDbGllbnRSZWN0cygpLmxlbmd0aCA+IDApO1xuXG4gICAgLyoqXG4gICAgICogRXh0cmFjdCBjaGVja2xpc3QgaHRtbCBmcm9tIHRvZG8gdGFibGVcbiAgICAgKiBAcGFyYW0geyp9IHRvZG9UYWJsZSBcbiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfSBodG1sIGNvbnRhaW5pbmcgdmlzaWJsZSBjaGVja2xpc3QgaXRlbXNcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBnZXRDaGVja0xpc3QodG9kb1RhYmxlKSB7XG4gICAgICAgIGxldCBjaGVja2xpc3QgPSB0b2RvVGFibGUuY2xvbmVOb2RlKHRydWUpO1xuICAgICAgICBjaGVja2xpc3QgPSBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNoZWNrbGlzdCk7XG4gICAgXG4gICAgICAgIC8vIFJlbW92ZSBub3QgdmlzaWJsZSByb3dzXG4gICAgICAgIGNoZWNrbGlzdD8ucXVlcnlTZWxlY3RvckFsbCgndHInKT8uZm9yRWFjaChyb3cgPT4ge1xuICAgICAgICAgICAgaWYgKGlzVmlzaWJsZShyb3cpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcm93LnJlbW92ZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGxldCBjaGVja2xpc3RIVE1MID0gY2hlY2tsaXN0Lm91dGVySFRNTDtcbiAgICAgICAgY2hlY2tsaXN0LnJlbW92ZSgpO1xuICAgICAgICByZXR1cm4gZW5jb2RlVVJJKGNoZWNrbGlzdEhUTUwpO1xuICAgIH1cbiAgICBcbiAgICAvKipcbiAgICAgKiBTZW5kIGNoZWNrbGlzdCBlbWFpbCB0aHJvdWdoIHdvcmRwcmVzcyBvbiBzdWJtaXRcbiAgICAgKiBAcGFyYW0geyp9IGUgXG4gICAgICovXG4gICAgZnVuY3Rpb24gaGFuZGxlU3VibWl0KGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIFxuICAgICAgICBjb25zdCBjdXJyZW50Rm9ybSA9IGUudGFyZ2V0O1xuICAgICAgICBjb25zdCBjdXJyZW50U2VjdGlvbiA9IGN1cnJlbnRGb3JtLmNsb3Nlc3QoU0VMRUNUT1JfVE9ET1NfV1JBUFBFUik7XG4gICAgICAgIGNvbnN0IHJlY2FwdGNoYSA9IGN1cnJlbnRGb3JtPy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX0lOUFVUX1JFQ0FQVENIQSk/LnZhbCgpO1xuICAgICAgICBjb25zdCBlbWFpbCA9IGN1cnJlbnRGb3JtPy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX0lOUFVUX0VNQUlMKT8udmFsdWU7XG4gICAgXG4gICAgICAgIGlmIChyZWNhcHRjaGEgPT09ICcnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgY29uc3QgdG9kb1RhYmxlID0gY3VycmVudFNlY3Rpb24/LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfVEFCTEUpO1xuICAgIFxuICAgICAgICBpZiAodG9kb1RhYmxlICYmIGVtYWlsICYmIGFqYXh1cmwpIHtcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrbGlzdCA9IGdldENoZWNrTGlzdCh0b2RvVGFibGUpOyBcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnZW1haWxfdG9kbycsXG4gICAgICAgICAgICAgICAgY2hlY2tsaXN0OiBjaGVja2xpc3QsXG4gICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgICAgICAgICAgIGNhcHRjaGE6IHJlY2FwdGNoYVxuICAgICAgICAgICAgfTtcbiAgICBcbiAgICAgICAgICAgICQucG9zdChhamF4dXJsLCBkYXRhLCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgPT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdWNjZXNzIScpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmYWlscyEnKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgXG4gICAgICAgICAgICAgICAgbG9jYXRpb24uaGFzaCA9ICcnO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogUXVlcnkgVG9EbyBzZWN0aW9ucyAmIHN1YnNjcmliZSBmb3JtXG4gICAgICovXG4gICAgZnVuY3Rpb24gc3Vic2NyaWJlU3VibWl0KCkge1xuICAgICAgICBjb25zdCB0b2RvU2VjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFNFTEVDVE9SX1RPRE9TX1dSQVBQRVIpO1xuICAgICAgICBpZiAodG9kb1NlY3Rpb25zPy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICB0b2RvU2VjdGlvbnMuZm9yRWFjaCh0b2RvU2VjdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybSA9IHRvZG9TZWN0aW9uPy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX0ZPUk0pO1xuICAgICAgICAgICAgICAgIGlmIChmb3JtKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgaGFuZGxlU3VibWl0KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBzdWJzY3JpYmVTdWJtaXQpO1xufSkoalF1ZXJ5KTtcbiIsImV4cG9ydCBkZWZhdWx0IChmdW5jdGlvbiAoJCkge1xuXG4gICAgZnVuY3Rpb24gQ2hlY2tib3hlcygpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVFdmVudHMoKTtcbiAgICAgICAgdGhpcy5jb250ZW50VG9nZ2xlRW5naW5lKCk7XG4gICAgfVxuXG4gICAgQ2hlY2tib3hlcy5wcm90b3R5cGUuaGFuZGxlRXZlbnRzID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdW2RhdGEtbW9kLWd1aWRlLXJlbGF0aW9uXScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xuXG4gICAgICAgICAgICBsZXQgcmVsYXRpb25zID0gJCh0aGlzKS5kYXRhKCdtb2QtZ3VpZGUtcmVsYXRpb24nKTtcbiAgICAgICAgICAgIHJlbGF0aW9ucyA9IHJlbGF0aW9ucy5zcGxpdCgnLCcpO1xuXG4gICAgICAgICAgICAkLmVhY2gocmVsYXRpb25zLCBmdW5jdGlvbiAoaW5kZXgsIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBsZXQgJGNiID0gJCgnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdW2RhdGEtbW9kLWd1aWRlLXRvZ2dsZS1rZXk9XCInICsgaXRlbSArICdcIl0nKTtcbiAgICAgICAgICAgICAgICAkY2IucHJvcCgnY2hlY2tlZCcsICEkY2IucHJvcCgnY2hlY2tlZCcpKS50cmlnZ2VyKCdjaGFuZ2UnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAkKCdbZGF0YS1tb2QtZ3VpZGUtdG9nZ2xlLWtleV0nKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHRoaXMuY29udGVudFRvZ2dsZUVuZ2luZSgpO1xuICAgICAgICB9LmJpbmQodGhpcykpO1xuXG5cbiAgICB9O1xuXG4gICAgQ2hlY2tib3hlcy5wcm90b3R5cGUuY29udGVudFRvZ2dsZUVuZ2luZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBHZXQgY2hlY2tlZCBjaGVja2JveGVzXG4gICAgICAgIGxldCBjaGVja2VkID0gW107XG4gICAgICAgIGxldCAkY2hlY2tib3hlcyA9ICQoJ1tkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5XScpO1xuXG4gICAgICAgICRjaGVja2JveGVzLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7XG4gICAgICAgICAgICBpZiAoJChlbGVtZW50KS5wcm9wKCdjaGVja2VkJykgIT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNoZWNrZWQucHVzaCgkKGVsZW1lbnQpLmF0dHIoJ2RhdGEtbW9kLWd1aWRlLXRvZ2dsZS1rZXknKSk7XG5cblxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBEaXNwbGF5IG9yIGhpZGUgY29udGVudFxuICAgICAgICAkKCdbZGF0YS1tb2QtZ3VpZGUtdG9nZ2xlLWtleS1jb250ZW50XScpLmVhY2goZnVuY3Rpb24gKGluZGV4LCBlbGVtZW50KSB7XG4gICAgICAgICAgICBsZXQgc2hvdWxkU2hvdyA9IGZhbHNlO1xuICAgICAgICAgICAgbGV0IGNvbmRpdGlvbnMgPSAkKGVsZW1lbnQpLmF0dHIoJ2RhdGEtbW9kLWd1aWRlLXRvZ2dsZS1rZXktY29udGVudCcpO1xuICAgICAgICAgICAgY29uZGl0aW9ucyA9IGNvbmRpdGlvbnMuc3BsaXQoJywnKTtcblxuICAgICAgICAgICAgLy8gRGF0ZXJtaW5kIGlmIGNvbnRlbnQgc2hvdWxkIGJlIHNob3duIG9yIG5vdFxuICAgICAgICAgICAgJC5lYWNoKGNvbmRpdGlvbnMsIGZ1bmN0aW9uIChpbmRleCwgaXRlbSkge1xuICAgICAgICAgICAgICAgIGxldCBhbmQgPSBpdGVtLm1hdGNoKC8oXnxcXCspKFteXFwrXFwtXSspL2cpO1xuICAgICAgICAgICAgICAgIGxldCBhbmRQYXR0ZXJuID0gbmV3IFJlZ0V4cCgnXFxcXGIoJyArIGFuZC5qb2luKCd8JykucmVwbGFjZSgnKycsICcnKSArICcpXFxcXGInLCAnaWcnKTtcbiAgICAgICAgICAgICAgICBsZXQgYW5kTWF0Y2hlcyA9IGNoZWNrZWQuam9pbignLCcpLm1hdGNoKGFuZFBhdHRlcm4pO1xuICAgICAgICAgICAgICAgIGxldCBhbmRJc01hdGNoaW5nID0gYW5kTWF0Y2hlcyAhPT0gbnVsbCAmJiBhbmRNYXRjaGVzLmxlbmd0aCA9PT0gYW5kLmxlbmd0aDtcblxuICAgICAgICAgICAgICAgIGxldCBhbmRub3QgPSBpdGVtLm1hdGNoKC9cXC0oW15cXCtcXC1dKykvZyk7XG4gICAgICAgICAgICAgICAgbGV0IGFuZG5vdElzTWF0Y2hpbmcgPSB0cnVlO1xuICAgICAgICAgICAgICAgIGlmIChhbmRub3QgIT09IG51bGwpIHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFuZG5vdFBhdHRlcm4gPSBuZXcgUmVnRXhwKCdcXFxcYignICsgYW5kbm90LmpvaW4oJ3wnKS5yZXBsYWNlKCctJywgJycpICsgJylcXFxcYicsICdpZycpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgYW5kbm90TWF0Y2hlcyA9IGNoZWNrZWQuam9pbignLCcpLm1hdGNoKGFuZG5vdFBhdHRlcm4pO1xuICAgICAgICAgICAgICAgICAgICBhbmRub3RJc01hdGNoaW5nID0gIShhbmRub3RNYXRjaGVzICE9PSBudWxsICYmIGFuZG5vdE1hdGNoZXMubGVuZ3RoID4gMCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGFuZElzTWF0Y2hpbmcgJiYgYW5kbm90SXNNYXRjaGluZykge1xuICAgICAgICAgICAgICAgICAgICBzaG91bGRTaG93ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gSGlkZSBvciBzaG93XG4gICAgICAgICAgICBpZiAoc2hvdWxkU2hvdyA9PT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgICQoZWxlbWVudCkuc2hvdygpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgJChlbGVtZW50KS5oaWRlKCk7XG4gICAgICAgICAgICByZXR1cm47XG5cblxuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIG5ldyBDaGVja2JveGVzKCk7XG5cbn0pKGpRdWVyeSk7XG4iLCJpbXBvcnQgJy4vQ29udGVudC9Ub2RvLmpzJztcbmltcG9ydCAnLi9Db250ZW50L2NoZWNrYm94ZXMuanMnO1xuXG4vLyBSZXF1aXJlZCBzZWxlY3RvcnNcbmNvbnN0IFNFTEVDVE9SX01PRFVMQVJJVFlfR1VJREUgPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGUnO1xuY29uc3QgU0VMRUNUT1JfU0VDVElPTiA9ICcuanMtbW9kdWxhcml0eS1ndWlkZV9fc2VjdGlvbic7XG5jb25zdCBTRUxFQ1RPUl9ORVhUID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlX19uZXh0JztcbmNvbnN0IFNFTEVDVE9SX1BSRVYgPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGVfX3ByZXYnO1xuY29uc3QgU0VMRUNUT1JfQUNDT1JESU9OX1RPR0dMRSA9ICdbanMtZXhwYW5kLWJ1dHRvbl0nO1xuXG4vLyBSZXF1aXJlZCBkYXRhLWF0dHJpYnV0ZXNcbmNvbnN0IEFUVFJJQlVURV9TVEVQID0gJ2RhdGEtZ3VpZGUtc3RlcCc7XG5cbi8qKlxuICogQ2xpY2sgaGFuZGxlciBmb3IgTmV4dCAmIFByZXYgYnV0dG9ucywgXG4gKiB3aWxsIHRyYXZlcnNlIHVwIHRvIGZpbmQgY3VycmVudCwgcHJldmlvdXMgYW5kIHRoZSBuZXh0IHN0ZXAgdG8gc2ltdWxhdGUgYWNjb3JkaW9uIGNsaWNrXG4gKiBAcGFyYW0geyp9IGUgZXZlbnRcbiAqL1xuZnVuY3Rpb24gaGFuZGxlUHJldk5leHRDbGljayhlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgcHJldk5leHRCdXR0b25FbGVtZW50ID0gZS50YXJnZXQ7XG4gICAgY29uc3QgaXNOZXh0ID0gZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFNFTEVDVE9SX05FWFQuc3Vic3RyaW5nKDEpKTtcblxuICAgIC8vIFRyYXZlcnNlIERPTSB1cHdhcmRzXG4gICAgY29uc3QgY3VycmVudEd1aWRlID0gcHJldk5leHRCdXR0b25FbGVtZW50Py5jbG9zZXN0KFNFTEVDVE9SX01PRFVMQVJJVFlfR1VJREUpO1xuICAgIGNvbnN0IGN1cnJlbnRTZWN0aW9uID0gcHJldk5leHRCdXR0b25FbGVtZW50Py5jbG9zZXN0KFNFTEVDVE9SX1NFQ1RJT04pO1xuICAgIGNvbnN0IGN1cnJlbnRTdGVwID0gcGFyc2VJbnQoY3VycmVudFNlY3Rpb24/LmdldEF0dHJpYnV0ZShBVFRSSUJVVEVfU1RFUCkgPz8gJy0xJyk7XG5cbiAgICBpZiAoY3VycmVudFN0ZXAgPiAwKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFN0ZXAgPSBpc05leHQgPyBjdXJyZW50U3RlcCArIDEgOiBjdXJyZW50U3RlcCAtIDE7XG4gICAgICAgIGNvbnN0IHRhcmdldFNlY3Rpb24gPSBjdXJyZW50R3VpZGU/LnF1ZXJ5U2VsZWN0b3IoYFske0FUVFJJQlVURV9TVEVQfT1cIiR7dGFyZ2V0U3RlcH1cIl1gKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0VG9nZ2xlID0gdGFyZ2V0U2VjdGlvbj8ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9BQ0NPUkRJT05fVE9HR0xFKTtcbiAgICAgICAgXG4gICAgICAgIGlmICh0YXJnZXRUb2dnbGUpIHtcbiAgICAgICAgICAgIHRhcmdldFRvZ2dsZS5jbGljaygpO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuLyoqXG4gKiBTdWJzY3JpYmUgcHJldi9uZXh0IGJ1dHRvbiBjbGljayBldmVudFxuICogQHBhcmFtIHtFbGVtZW50fSB3cmFwcGVyRWxlbWVudCBcbiAqL1xuZnVuY3Rpb24gc3Vic2NyaWJlUHJldk5leHRCdXR0b25zKHdyYXBwZXJFbGVtZW50KSB7XG4gICAgY29uc3QgYnV0dG9ucyA9IFtcbiAgICAgICAgLi4ud3JhcHBlckVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChgJHtTRUxFQ1RPUl9TRUNUSU9OfSAke1NFTEVDVE9SX05FWFR9YCksXG4gICAgICAgIC4uLndyYXBwZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCR7U0VMRUNUT1JfU0VDVElPTn0gJHtTRUxFQ1RPUl9QUkVWfWApLFxuICAgIF07XG5cbiAgICBpZiAoYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b25FbGVtZW50ID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVQcmV2TmV4dENsaWNrKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFF1ZXJ5IGd1aWRlIG1vZHVsZXMgJiBpbml0aWFsaXplIHN0dWZmXG4gKi9cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgY29uc3QgZ3VpZGVNb2R1bGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChTRUxFQ1RPUl9NT0RVTEFSSVRZX0dVSURFKTtcblxuICAgIGlmIChndWlkZU1vZHVsZXMgJiYgZ3VpZGVNb2R1bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZ3VpZGVNb2R1bGVzLmZvckVhY2goc3Vic2NyaWJlUHJldk5leHRCdXR0b25zKTtcbiAgICB9XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCk7Il0sInNvdXJjZVJvb3QiOiIifQ==