!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([,function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function c(e){r(a,o,i,c,u,"next",e)}function u(e){r(a,o,i,c,u,"throw",e)}c(void 0)}))}}function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.r(t);(function(e){var t={info:"c-notice--info",success:"c-notice--success",danger:"c-notice--danger",warning:"c-notice--warning"},n={};function r(n){var r,o;n.preventDefault();var a=n.target,c=a.closest(".js-modularity-guide-todos"),u=null==a||null===(r=a.querySelector('textarea[name="g-recaptcha-response"]'))||void 0===r?void 0:r.value,l=null==a||null===(o=a.querySelector('input[name="email"]'))||void 0===o?void 0:o.value;if(""===u)return!1;function d(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=c.querySelector(".js-modularity-guide-todos__notice"),a=o.querySelectorAll("c-icon"),u=o.classList,l=t[n];if(!1!==e){if(l&&!u.contains(l)&&(i(u).filter((function(e){return Object.values(t).includes(e)})).forEach((function(e){u.remove(e)})),u.add(l)),e.length>0){var d=o.querySelectorAll("span"),s=2===d.length?d[1]:d[0];s.innerHTML=e,r.length>0&&a&&(a.innerHTML=r),u.remove("u-display--none")}}else u.contains("u-display--none")||u.add("u-display--none")}d(!1);var s=null==c?void 0:c.querySelector(".js-modularity-guide-todos__table");if(s&&l&&ajaxurl){c.classList.toggle("is-loading");var f={action:"email_todo",checklist:function(e){var t,n,r=e.cloneNode(!0);null===(t=r=document.body.appendChild(r))||void 0===t||null===(n=t.querySelectorAll("tr"))||void 0===n||n.forEach((function(e){var t;(t=e).offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0||e.remove()}));var o=r.outerHTML;return r.remove(),encodeURI(o)}(s),email:l,captcha:u};e.post(ajaxurl,f,(function(e){c.classList.toggle("is-loading"),"success"==e?(d(guides.email_sent,"success","report"),setTimeout((function(){d(!1);var e=c.querySelector(".js-modularity-guide-todos__modal .c-modal__close");e&&e.click()}),2e3)):d(guides.email_failed,"danger","report")}))}}function a(e,t){var r=e.querySelector(".js-modularity-guide-todos__modal-trigger");null==r||r.addEventListener("click",(function(){!function(e,t){var r,i=null==e?void 0:e.querySelector(".js-modularity-guide-todos__grecaptcha"),a=null==i?void 0:i.getAttribute("data-sitekey");function c(e){return u.apply(this,arguments)}function u(){return(u=o(regeneratorRuntime.mark((function r(o){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:try{e.classList.toggle("is-disabled"),e.classList.contains("is-disabled")&&grecaptcha.reset(n["GreCaptchaWidget-".concat(t)])}catch(e){console.log(e)}case 1:case"end":return r.stop()}}),r)})))).apply(this,arguments)}(null===(r=grecaptcha)||void 0===r?void 0:r.render)&&i&&a&&(e.classList.toggle("is-disabled"),n["GreCaptchaWidget-".concat(t)]=grecaptcha.render(i,{sitekey:a,callback:c,"expired-callback":c}))}(e,t)}),{once:!0})}window.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".js-modularity-guide-todos");(null==e?void 0:e.length)>0&&e.forEach((function(e,t){a(e,t),function(e,t){var n;null==e||null===(n=e.querySelector(".js-modularity-guide-todos__form"))||void 0===n||n.addEventListener("submit",r)}(e)}))}))})(jQuery),function(e){function t(){this.handleEvents(),this.contentToggleEngine()}t.prototype.handleEvents=function(){e('input[type="checkbox"][data-mod-guide-relation]').on("change",(function(t){var n=e(this).data("mod-guide-relation");n=n.split(","),e.each(n,(function(t,n){var r=e('input[type="checkbox"][data-mod-guide-toggle-key="'+n+'"]');r.prop("checked",!r.prop("checked")).trigger("change")}))})),e("[data-mod-guide-toggle-key]").on("change",function(e){this.contentToggleEngine()}.bind(this))},t.prototype.contentToggleEngine=function(){var t=[];e("[data-mod-guide-toggle-key]").each((function(n,r){!0===e(r).prop("checked")&&t.push(e(r).attr("data-mod-guide-toggle-key"))})),e("[data-mod-guide-toggle-key-content]").each((function(n,r){var o=!1,i=e(r).attr("data-mod-guide-toggle-key-content");i=i.split(","),e.each(i,(function(e,n){var r=n.match(/(^|\+)([^\+\-]+)/g),i=new RegExp("\\b("+r.join("|").replace("+","")+")\\b","ig"),a=t.join(",").match(i),c=null!==a&&a.length===r.length,u=n.match(/\-([^\+\-]+)/g),l=!0;if(null!==u){var d=new RegExp("\\b("+u.join("|").replace("-","")+")\\b","ig"),s=t.join(",").match(d);l=!(null!==s&&s.length>0)}c&&l&&(o=!0)})),!0!==o?e(r).hide():e(r).show()}))},new t}(jQuery);function c(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e){var t;e.preventDefault();var n=e.target,r=e.target.classList.contains(".js-modularity-guide__next".substring(1)),o=null==n?void 0:n.closest(".js-modularity-guide"),i=null==n?void 0:n.closest(".js-modularity-guide__section"),a=parseInt(null!==(t=null==i?void 0:i.getAttribute("data-guide-step"))&&void 0!==t?t:"-1");if(a>0){var c=r?a+1:a-1,u=null==o?void 0:o.querySelector("[".concat("data-guide-step",'="').concat(c,'"]')),l=null==u?void 0:u.querySelector("[js-expand-button]");l&&l.click()}}function d(e){var t=[].concat(c(e.querySelectorAll("".concat(".js-modularity-guide__section"," ").concat(".js-modularity-guide__next"))),c(e.querySelectorAll("".concat(".js-modularity-guide__section"," ").concat(".js-modularity-guide__prev"))));t.length>0&&t.forEach((function(e){e.addEventListener("click",l)}))}window.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".js-modularity-guide");e&&e.length>0&&e.forEach(d)}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL0NvbnRlbnQvVG9kby5qcyIsIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvQ29udGVudC9jaGVja2JveGVzLmpzIiwid2VicGFjazovLy8uL3NvdXJjZS9qcy9tb2R1bGFyaXR5LWd1aWRlcy5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIiQiLCJOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FUyIsImluZm8iLCJzdWNjZXNzIiwiZGFuZ2VyIiwid2FybmluZyIsIlJFQ0FQVENIQV9XSURHRVRTIiwiaGFuZGxlU3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiY3VycmVudEZvcm0iLCJ0YXJnZXQiLCJjdXJyZW50U2VjdGlvbiIsImNsb3Nlc3QiLCJyZWNhcHRjaGEiLCJxdWVyeVNlbGVjdG9yIiwiZW1haWwiLCJzZXROb3RpY2UiLCJ0ZXh0IiwibGV2ZWwiLCJpY29uIiwibm90aWNlRWxlbWVudCIsIm5vdGljZUljb25FbGVtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIm5vdGljZUNsYXNzTGlzdCIsImNsYXNzTGlzdCIsIm5vdGljZUxldmVsQ2xhc3NOYW1lIiwiY29udGFpbnMiLCJmaWx0ZXIiLCJjbGFzc05hbWUiLCJ2YWx1ZXMiLCJpbmNsdWRlcyIsImZvckVhY2giLCJyZW1vdmUiLCJhZGQiLCJsZW5ndGgiLCJzcGFuRWxlbWVudHMiLCJ0ZXh0U3BhbiIsImlubmVySFRNTCIsInRvZG9UYWJsZSIsImFqYXh1cmwiLCJ0b2dnbGUiLCJkYXRhIiwiYWN0aW9uIiwiY2hlY2tsaXN0IiwiY2xvbmVOb2RlIiwiZG9jdW1lbnQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJyb3ciLCJlbGVtIiwib2Zmc2V0V2lkdGgiLCJvZmZzZXRIZWlnaHQiLCJnZXRDbGllbnRSZWN0cyIsImNoZWNrbGlzdEhUTUwiLCJvdXRlckhUTUwiLCJlbmNvZGVVUkkiLCJnZXRDaGVja0xpc3QiLCJjYXB0Y2hhIiwicG9zdCIsInJlc3BvbnNlIiwiZ3VpZGVzIiwiZW1haWxfc2VudCIsInNldFRpbWVvdXQiLCJjbG9zZU1vZGFsIiwiY2xpY2siLCJlbWFpbF9mYWlsZWQiLCJzdWJzY3JpYmVNb2RhbFRyaWdnZXIiLCJ0b2RvU2VjdGlvbiIsImluZGV4IiwibW9kYWxUcmlnZ2VyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInJlY2FwdGNoYUNvbnRhaW5lciIsInJlY2FwdGNoYVNpdGVLZXkiLCJnZXRBdHRyaWJ1dGUiLCJoYW5kbGVSZWNhcHRjaGEiLCJncmVjYXB0Y2hhIiwicmVzZXQiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyZW5kZXIiLCJzaXRla2V5IiwiY2FsbGJhY2siLCJyZW5kZXJSZWNhcHRjaGEiLCJvbmNlIiwid2luZG93IiwidG9kb1NlY3Rpb25zIiwic3Vic2NyaWJlRm9ybSIsImpRdWVyeSIsIkNoZWNrYm94ZXMiLCJ0aGlzIiwiaGFuZGxlRXZlbnRzIiwiY29udGVudFRvZ2dsZUVuZ2luZSIsIm9uIiwicmVsYXRpb25zIiwic3BsaXQiLCJlYWNoIiwiaXRlbSIsIiRjYiIsInByb3AiLCJ0cmlnZ2VyIiwiY2hlY2tlZCIsImVsZW1lbnQiLCJwdXNoIiwiYXR0ciIsInNob3VsZFNob3ciLCJjb25kaXRpb25zIiwiYW5kIiwibWF0Y2giLCJhbmRQYXR0ZXJuIiwiUmVnRXhwIiwiam9pbiIsInJlcGxhY2UiLCJhbmRNYXRjaGVzIiwiYW5kSXNNYXRjaGluZyIsImFuZG5vdCIsImFuZG5vdElzTWF0Y2hpbmciLCJhbmRub3RQYXR0ZXJuIiwiYW5kbm90TWF0Y2hlcyIsImhpZGUiLCJzaG93IiwiaGFuZGxlUHJldk5leHRDbGljayIsInByZXZOZXh0QnV0dG9uRWxlbWVudCIsImlzTmV4dCIsInN1YnN0cmluZyIsImN1cnJlbnRHdWlkZSIsImN1cnJlbnRTdGVwIiwicGFyc2VJbnQiLCJ0YXJnZXRTdGVwIiwidGFyZ2V0U2VjdGlvbiIsInRhcmdldFRvZ2dsZSIsInN1YnNjcmliZVByZXZOZXh0QnV0dG9ucyIsIndyYXBwZXJFbGVtZW50IiwiYnV0dG9ucyIsImJ1dHRvbkVsZW1lbnQiLCJndWlkZU1vZHVsZXMiXSwibWFwcGluZ3MiOiJhQUNFLElBQUlBLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVDLFFBR25DLElBQUlDLEVBQVNKLEVBQWlCRSxHQUFZLENBQ3pDRyxFQUFHSCxFQUNISSxHQUFHLEVBQ0hILFFBQVMsSUFVVixPQU5BSSxFQUFRTCxHQUFVTSxLQUFLSixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTRixHQUcvREcsRUFBT0UsR0FBSSxFQUdKRixFQUFPRCxRQUtmRixFQUFvQlEsRUFBSUYsRUFHeEJOLEVBQW9CUyxFQUFJVixFQUd4QkMsRUFBb0JVLEVBQUksU0FBU1IsRUFBU1MsRUFBTUMsR0FDM0NaLEVBQW9CYSxFQUFFWCxFQUFTUyxJQUNsQ0csT0FBT0MsZUFBZWIsRUFBU1MsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFWixFQUFvQmtCLEVBQUksU0FBU2hCLEdBQ1gsb0JBQVhpQixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWViLEVBQVNpQixPQUFPQyxZQUFhLENBQUVDLE1BQU8sV0FFN0RQLE9BQU9DLGVB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VUFBQ3BILGFBQUQsRUFBQ0EsRUFBZ0I4RCxhQWhCMUIsMEJBZ0JTLFFBQWlELE1BRTdFLEdBQUlxRCxFQUFjLEVBQUcsQ0FDakIsSUFBTUUsRUFBYUwsRUFBU0csRUFBYyxFQUFJQSxFQUFjLEVBQ3RERyxFQUFnQkosYUFBSCxFQUFHQSxFQUFjL0csY0FBZCxXQXBCUCxrQkFvQk8sYUFBbURrSCxFQUFuRCxPQUNoQkUsRUFBZUQsYUFBSCxFQUFHQSxFQUFlbkgsY0F4QlYsc0JBMEJ0Qm9ILEdBQ0FBLEVBQWFsRSxTQVN6QixTQUFTbUUsRUFBeUJDLEdBQzlCLElBQU1DLEVBQVUsR0FBSCxTQUNORCxFQUFlOUcsaUJBQWYsVUF6Q2MsZ0NBeUNkLFlBeENXLGdDQXVDTCxFQUVOOEcsRUFBZTlHLGlCQUFmLFVBMUNjLGdDQTBDZCxZQXhDVyxpQ0EyQ2QrRyxFQUFRbkcsT0FBUyxHQUNqQm1HLEVBQVF0RyxTQUFRLFNBQUF1RyxHQUNaQSxFQUFjaEUsaUJBQWlCLFFBQVNtRCxNQWdCcERwQyxPQUFPZixpQkFBaUIsb0JBUnhCLFdBQ0ksSUFBTWlFLEVBQWUxRixTQUFTdkIsaUJBekRBLHdCQTJEMUJpSCxHQUFnQkEsRUFBYXJHLE9BQVMsR0FDdENxRyxFQUFheEcsUUFBUW9HIiwiZmlsZSI6ImpzL21vZHVsYXJpdHktZ3VpZGVzLjE5YzNiNmZhMmEwY2IyNDA2Y2E0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uICgkKSB7XG4gICAgY29uc3QgU0VMRUNUT1JfVE9ET1NfV1JBUFBFUiA9ICcuanMtbW9kdWxhcml0eS1ndWlkZS10b2Rvcyc7XG4gICAgY29uc3QgU0VMRUNUT1JfRk9STSA9ICcuanMtbW9kdWxhcml0eS1ndWlkZS10b2Rvc19fZm9ybSc7XG4gICAgY29uc3QgU0VMRUNUT1JfTU9EQUxfQ0xPU0VfQlVUVE9OID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlLXRvZG9zX19tb2RhbCAuYy1tb2RhbF9fY2xvc2UnO1xuICAgIGNvbnN0IFNFTEVDVE9SX01PREFMX1RSSUdHRVJfQlVUVE9OID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlLXRvZG9zX19tb2RhbC10cmlnZ2VyJztcbiAgICBjb25zdCBTRUxFQ1RPUl9GT1JNX05PVElDRSA9ICcuanMtbW9kdWxhcml0eS1ndWlkZS10b2Rvc19fbm90aWNlJztcbiAgICBjb25zdCBTRUxFQ1RPUl9UQUJMRSA9ICcuanMtbW9kdWxhcml0eS1ndWlkZS10b2Rvc19fdGFibGUnO1xuICAgIGNvbnN0IFNFTEVDVE9SX0dSRUNBUFRDSEFfQ09OVEFJTkVSID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlLXRvZG9zX19ncmVjYXB0Y2hhJztcbiAgICBjb25zdCBTRUxFQ1RPUl9JTlBVVF9SRUNBUFRDSEEgPSAndGV4dGFyZWFbbmFtZT1cImctcmVjYXB0Y2hhLXJlc3BvbnNlXCJdJztcbiAgICBjb25zdCBTRUxFQ1RPUl9JTlBVVF9FTUFJTCA9ICdpbnB1dFtuYW1lPVwiZW1haWxcIl0nO1xuICAgIFxuICAgIGNvbnN0IE5PVElDRV9MRVZFTF9DTEFTU05BTUVTID0ge1xuICAgICAgICBpbmZvOiAnYy1ub3RpY2UtLWluZm8nLCBcbiAgICAgICAgc3VjY2VzczogJ2Mtbm90aWNlLS1zdWNjZXNzJywgXG4gICAgICAgIGRhbmdlcjogJ2Mtbm90aWNlLS1kYW5nZXInLCBcbiAgICAgICAgd2FybmluZzogJ2Mtbm90aWNlLS13YXJuaW5nJ1xuICAgIH07XG4gICAgXG4gICAgbGV0IFJFQ0FQVENIQV9XSURHRVRTID0ge307ICAgIFxuXG4gICAgLyoqXG4gICAgICogVXRpbGl0eSB0byBjaGVjayBpZiBlbGVtZW50IGlzIHZpc2libGUgb3Igbm90XG4gICAgICogQHBhcmFtIHsqfSBlbGVtIFxuICAgICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgICAqL1xuICAgIGNvbnN0IGlzVmlzaWJsZSA9IChlbGVtKSA9PiAoZWxlbS5vZmZzZXRXaWR0aCA+IDAgfHwgZWxlbS5vZmZzZXRIZWlnaHQgPiAwIHx8IGVsZW0uZ2V0Q2xpZW50UmVjdHMoKS5sZW5ndGggPiAwKTtcblxuICAgIC8qKlxuICAgICAqIEV4dHJhY3QgY2hlY2tsaXN0IGh0bWwgZnJvbSB0b2RvIHRhYmxlXG4gICAgICogQHBhcmFtIHsqfSB0b2RvVGFibGUgXG4gICAgICogQHJldHVybnMge3N0cmluZ30gaHRtbCB3aXRoIHZpc2libGUgY2hlY2tsaXN0IGl0ZW1zXG4gICAgICovXG4gICAgZnVuY3Rpb24gZ2V0Q2hlY2tMaXN0KHRvZG9UYWJsZSkge1xuICAgICAgICBsZXQgY2hlY2tsaXN0ID0gdG9kb1RhYmxlLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgICAgY2hlY2tsaXN0ID0gZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjaGVja2xpc3QpO1xuICAgIFxuICAgICAgICAvLyBSZW1vdmUgbm90IHZpc2libGUgcm93c1xuICAgICAgICBjaGVja2xpc3Q/LnF1ZXJ5U2VsZWN0b3JBbGwoJ3RyJyk/LmZvckVhY2gocm93ID0+IHtcbiAgICAgICAgICAgIGlmIChpc1Zpc2libGUocm93KSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJvdy5yZW1vdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICBsZXQgY2hlY2tsaXN0SFRNTCA9IGNoZWNrbGlzdC5vdXRlckhUTUw7XG4gICAgICAgIGNoZWNrbGlzdC5yZW1vdmUoKTtcbiAgICAgICAgcmV0dXJuIGVuY29kZVVSSShjaGVja2xpc3RIVE1MKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZW5kIGNoZWNrbGlzdCBlbWFpbCB0aHJvdWdoIHdvcmRwcmVzcyBvbiBzdWJtaXRcbiAgICAgKiBAcGFyYW0geyp9IGUgXG4gICAgICovXG4gICAgZnVuY3Rpb24gaGFuZGxlU3VibWl0KGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIFxuICAgICAgICBjb25zdCBjdXJyZW50Rm9ybSA9IGUudGFyZ2V0O1xuICAgICAgICBjb25zdCBjdXJyZW50U2VjdGlvbiA9IGN1cnJlbnRGb3JtLmNsb3Nlc3QoU0VMRUNUT1JfVE9ET1NfV1JBUFBFUik7XG4gICAgICAgIGNvbnN0IHJlY2FwdGNoYSA9IGN1cnJlbnRGb3JtPy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX0lOUFVUX1JFQ0FQVENIQSk/LnZhbHVlO1xuICAgICAgICBjb25zdCBlbWFpbCA9IGN1cnJlbnRGb3JtPy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX0lOUFVUX0VNQUlMKT8udmFsdWU7XG4gICAgXG4gICAgICAgIGlmIChyZWNhcHRjaGEgPT09ICcnKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICBcbiAgICAgICAgLyoqXG4gICAgICAgICAqIERpc3BsYXkgb3IgaGlkZSBmb3JtIG5vdGljZVxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZy9ib29sZWFufSB0ZXh0IG5vdGljZSBjb250ZW50LCBzZXQgdG8gZmFsc2UgdG8gaGlkZSBub3RpY2UgXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsZXZlbCAgbm90aWNlIGxldmVsIC0gaW5mbywgZGFuZ2VyLCB3YXJuaW5nLCBzdWNjZXNzXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBpY29uIG1hdGVyaWFsIGljb24gbmFtZVxuICAgICAgICAgKiBAcmV0dXJuc1xuICAgICAgICAgKi9cbiAgICAgICAgZnVuY3Rpb24gc2V0Tm90aWNlKHRleHQsIGxldmVsID0gJ2luZm8nLCBpY29uID0gJycpIHtcbiAgICAgICAgICAgIGNvbnN0IG5vdGljZUVsZW1lbnQgPSBjdXJyZW50U2VjdGlvbi5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX0ZPUk1fTk9USUNFKTtcbiAgICAgICAgICAgIGNvbnN0IG5vdGljZUljb25FbGVtZW50ID0gbm90aWNlRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCdjLWljb24nKTtcbiAgICAgICAgICAgIGNvbnN0IG5vdGljZUNsYXNzTGlzdCA9IG5vdGljZUVsZW1lbnQuY2xhc3NMaXN0O1xuICAgICAgICAgICAgY29uc3Qgbm90aWNlTGV2ZWxDbGFzc05hbWUgPSBOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FU1tsZXZlbF07XG5cbiAgICAgICAgICAgIGlmICh0ZXh0ID09PSBmYWxzZSkge1xuICAgICAgICAgICAgICAgIGlmICghbm90aWNlQ2xhc3NMaXN0LmNvbnRhaW5zKCd1LWRpc3BsYXktLW5vbmUnKSkge1xuICAgICAgICAgICAgICAgICAgICBub3RpY2VDbGFzc0xpc3QuYWRkKCd1LWRpc3BsYXktLW5vbmUnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChub3RpY2VMZXZlbENsYXNzTmFtZSAmJiAhbm90aWNlQ2xhc3NMaXN0LmNvbnRhaW5zKG5vdGljZUxldmVsQ2xhc3NOYW1lKSkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIFsuLi5ub3RpY2VDbGFzc0xpc3RdXG4gICAgICAgICAgICAgICAgLmZpbHRlcihjbGFzc05hbWUgPT4gKFxuICAgICAgICAgICAgICAgICAgICBPYmplY3QudmFsdWVzKE5PVElDRV9MRVZFTF9DTEFTU05BTUVTKS5pbmNsdWRlcyhjbGFzc05hbWUpXG4gICAgICAgICAgICAgICAgKSlcbiAgICAgICAgICAgICAgICAuZm9yRWFjaChjbGFzc05hbWUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBub3RpY2VDbGFzc0xpc3QucmVtb3ZlKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBub3RpY2VDbGFzc0xpc3QuYWRkKG5vdGljZUxldmVsQ2xhc3NOYW1lKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHRleHQubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNwYW5FbGVtZW50cyA9IG5vdGljZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnc3BhbicpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHRleHRTcGFuID0gc3BhbkVsZW1lbnRzLmxlbmd0aCA9PT0gMiA/IHNwYW5FbGVtZW50c1sxXSA6IHNwYW5FbGVtZW50c1swXTtcbiAgICAgICAgICAgICAgICB0ZXh0U3Bhbi5pbm5lckhUTUwgPSB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKGljb24ubGVuZ3RoID4gMCAmJiBub3RpY2VJY29uRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBub3RpY2VJY29uRWxlbWVudC5pbm5lckhUTUwgPSBpY29uO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIG5vdGljZUNsYXNzTGlzdC5yZW1vdmUoJ3UtZGlzcGxheS0tbm9uZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXROb3RpY2UoZmFsc2UpO1xuXG4gICAgICAgIGNvbnN0IHRvZG9UYWJsZSA9IGN1cnJlbnRTZWN0aW9uPy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX1RBQkxFKTtcbiAgICBcbiAgICAgICAgaWYgKHRvZG9UYWJsZSAmJiBlbWFpbCAmJiBhamF4dXJsKSB7XG4gICAgICAgICAgICBjdXJyZW50U2VjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1sb2FkaW5nJyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IGNoZWNrbGlzdCA9IGdldENoZWNrTGlzdCh0b2RvVGFibGUpOyBcbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgICAgICAgICAgYWN0aW9uOiAnZW1haWxfdG9kbycsXG4gICAgICAgICAgICAgICAgY2hlY2tsaXN0OiBjaGVja2xpc3QsXG4gICAgICAgICAgICAgICAgZW1haWw6IGVtYWlsLFxuICAgICAgICAgICAgICAgIGNhcHRjaGE6IHJlY2FwdGNoYVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJC5wb3N0KGFqYXh1cmwsIGRhdGEsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRTZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWxvYWRpbmcnKTtcbiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgPT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIHNldE5vdGljZShndWlkZXMuZW1haWxfc2VudCwgJ3N1Y2Nlc3MnLCAncmVwb3J0Jyk7XG4gICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgc2V0Tm90aWNlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsb3NlTW9kYWwgPSBjdXJyZW50U2VjdGlvbi5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX01PREFMX0NMT1NFX0JVVFRPTik7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2xvc2VNb2RhbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsb3NlTW9kYWwuY2xpY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9LCAyMDAwKTtcblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHNldE5vdGljZShndWlkZXMuZW1haWxfZmFpbGVkLCAnZGFuZ2VyJywgJ3JlcG9ydCcpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7ZWxlbWVudH0gdG9kb1NlY3Rpb24gXG4gICAgICogQHBhcmFtIHtpbnR9IGluZGV4IFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHN1YnNjcmliZUZvcm0odG9kb1NlY3Rpb24sIGluZGV4KSB7XG4gICAgICAgIHRvZG9TZWN0aW9uPy5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX0ZPUk0pPy5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBoYW5kbGVTdWJtaXQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7ZWxlbWVudH0gdG9kb1NlY3Rpb24gXG4gICAgICogQHBhcmFtIHtpbnR9IGluZGV4IFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHJlbmRlclJlY2FwdGNoYSh0b2RvU2VjdGlvbiwgaW5kZXgpIHtcbiAgICAgICAgY29uc3QgcmVjYXB0Y2hhQ29udGFpbmVyID0gdG9kb1NlY3Rpb24/LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfR1JFQ0FQVENIQV9DT05UQUlORVIpO1xuICAgICAgICBjb25zdCByZWNhcHRjaGFTaXRlS2V5ID0gcmVjYXB0Y2hhQ29udGFpbmVyPy5nZXRBdHRyaWJ1dGUoJ2RhdGEtc2l0ZWtleScpO1xuXG4gICAgICAgIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZVJlY2FwdGNoYShlKSB7XG4gICAgICAgICAgICB0cnkgeyAgICAgXG4gICAgICAgICAgICAgICAgdG9kb1NlY3Rpb24uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtZGlzYWJsZWQnKTsgICBcbiAgICAgICAgICAgICAgICBpZiAodG9kb1NlY3Rpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdpcy1kaXNhYmxlZCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIGdyZWNhcHRjaGEucmVzZXQoUkVDQVBUQ0hBX1dJREdFVFNbYEdyZUNhcHRjaGFXaWRnZXQtJHtpbmRleH1gXSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaChlcnJvcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgXG4gICAgICAgIGlmIChncmVjYXB0Y2hhPy5yZW5kZXIgJiYgcmVjYXB0Y2hhQ29udGFpbmVyICYmIHJlY2FwdGNoYVNpdGVLZXkpIHtcbiAgICAgICAgICAgIHRvZG9TZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ2lzLWRpc2FibGVkJyk7XG4gICAgICAgICAgICBSRUNBUFRDSEFfV0lER0VUU1tgR3JlQ2FwdGNoYVdpZGdldC0ke2luZGV4fWBdID0gZ3JlY2FwdGNoYS5yZW5kZXIocmVjYXB0Y2hhQ29udGFpbmVyLCB7XG4gICAgICAgICAgICAgICAgc2l0ZWtleTogcmVjYXB0Y2hhU2l0ZUtleSxcbiAgICAgICAgICAgICAgICBjYWxsYmFjazogaGFuZGxlUmVjYXB0Y2hhLFxuICAgICAgICAgICAgICAgICdleHBpcmVkLWNhbGxiYWNrJzogaGFuZGxlUmVjYXB0Y2hhLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIC8qKlxuICAgICAqIFxuICAgICAqIEBwYXJhbSB7ZWxlbWVudH0gdG9kb1NlY3Rpb24gXG4gICAgICogQHBhcmFtIHtpbnR9IGluZGV4IFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIHN1YnNjcmliZU1vZGFsVHJpZ2dlcih0b2RvU2VjdGlvbiwgaW5kZXgpXG4gICAge1xuICAgICAgICBjb25zdCBtb2RhbFRyaWdnZXIgPSB0b2RvU2VjdGlvbi5xdWVyeVNlbGVjdG9yKFNFTEVDVE9SX01PREFMX1RSSUdHRVJfQlVUVE9OKTtcblxuICAgICAgICBtb2RhbFRyaWdnZXI/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZW5kZXJSZWNhcHRjaGEodG9kb1NlY3Rpb24sIGluZGV4KTtcbiAgICAgICAgfSx7b25jZTogdHJ1ZX0pO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogUXVlcnkgVG9EbyBzZWN0aW9ucyAmIGluaXRpYWxpemUgZ3JlYXQgdGhpbmdzXG4gICAgICovXG4gICAgZnVuY3Rpb24gaW5pdCgpIHtcbiAgICAgICAgY29uc3QgdG9kb1NlY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChTRUxFQ1RPUl9UT0RPU19XUkFQUEVSKTtcbiAgICAgICAgaWYgKHRvZG9TZWN0aW9ucz8ubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdG9kb1NlY3Rpb25zLmZvckVhY2goKHRvZG9TZWN0aW9uLCBpbmRleCkgPT4ge1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZU1vZGFsVHJpZ2dlcih0b2RvU2VjdGlvbiwgaW5kZXgpO1xuICAgICAgICAgICAgICAgIHN1YnNjcmliZUZvcm0odG9kb1NlY3Rpb24sIGluZGV4KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBpbml0KTtcbn0pKGpRdWVyeSk7XG4iLCJleHBvcnQgZGVmYXVsdCAoZnVuY3Rpb24gKCQpIHtcblxuICAgIGZ1bmN0aW9uIENoZWNrYm94ZXMoKSB7XG4gICAgICAgIHRoaXMuaGFuZGxlRXZlbnRzKCk7XG4gICAgICAgIHRoaXMuY29udGVudFRvZ2dsZUVuZ2luZSgpO1xuICAgIH1cblxuICAgIENoZWNrYm94ZXMucHJvdG90eXBlLmhhbmRsZUV2ZW50cyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXVtkYXRhLW1vZC1ndWlkZS1yZWxhdGlvbl0nKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKGUpIHtcblxuICAgICAgICAgICAgbGV0IHJlbGF0aW9ucyA9ICQodGhpcykuZGF0YSgnbW9kLWd1aWRlLXJlbGF0aW9uJyk7XG4gICAgICAgICAgICByZWxhdGlvbnMgPSByZWxhdGlvbnMuc3BsaXQoJywnKTtcblxuICAgICAgICAgICAgJC5lYWNoKHJlbGF0aW9ucywgZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7XG4gICAgICAgICAgICAgICAgbGV0ICRjYiA9ICQoJ2lucHV0W3R5cGU9XCJjaGVja2JveFwiXVtkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5PVwiJyArIGl0ZW0gKyAnXCJdJyk7XG4gICAgICAgICAgICAgICAgJGNiLnByb3AoJ2NoZWNrZWQnLCAhJGNiLnByb3AoJ2NoZWNrZWQnKSkudHJpZ2dlcignY2hhbmdlJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJCgnW2RhdGEtbW9kLWd1aWRlLXRvZ2dsZS1rZXldJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnRUb2dnbGVFbmdpbmUoKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpKTtcblxuXG4gICAgfTtcblxuICAgIENoZWNrYm94ZXMucHJvdG90eXBlLmNvbnRlbnRUb2dnbGVFbmdpbmUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gR2V0IGNoZWNrZWQgY2hlY2tib3hlc1xuICAgICAgICBsZXQgY2hlY2tlZCA9IFtdO1xuICAgICAgICBsZXQgJGNoZWNrYm94ZXMgPSAkKCdbZGF0YS1tb2QtZ3VpZGUtdG9nZ2xlLWtleV0nKTtcblxuICAgICAgICAkY2hlY2tib3hlcy5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xuICAgICAgICAgICAgaWYgKCQoZWxlbWVudCkucHJvcCgnY2hlY2tlZCcpICE9PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjaGVja2VkLnB1c2goJChlbGVtZW50KS5hdHRyKCdkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5JykpO1xuXG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gRGlzcGxheSBvciBoaWRlIGNvbnRlbnRcbiAgICAgICAgJCgnW2RhdGEtbW9kLWd1aWRlLXRvZ2dsZS1rZXktY29udGVudF0nKS5lYWNoKGZ1bmN0aW9uIChpbmRleCwgZWxlbWVudCkge1xuICAgICAgICAgICAgbGV0IHNob3VsZFNob3cgPSBmYWxzZTtcbiAgICAgICAgICAgIGxldCBjb25kaXRpb25zID0gJChlbGVtZW50KS5hdHRyKCdkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5LWNvbnRlbnQnKTtcbiAgICAgICAgICAgIGNvbmRpdGlvbnMgPSBjb25kaXRpb25zLnNwbGl0KCcsJyk7XG5cbiAgICAgICAgICAgIC8vIERhdGVybWluZCBpZiBjb250ZW50IHNob3VsZCBiZSBzaG93biBvciBub3RcbiAgICAgICAgICAgICQuZWFjaChjb25kaXRpb25zLCBmdW5jdGlvbiAoaW5kZXgsIGl0ZW0pIHtcbiAgICAgICAgICAgICAgICBsZXQgYW5kID0gaXRlbS5tYXRjaCgvKF58XFwrKShbXlxcK1xcLV0rKS9nKTtcbiAgICAgICAgICAgICAgICBsZXQgYW5kUGF0dGVybiA9IG5ldyBSZWdFeHAoJ1xcXFxiKCcgKyBhbmQuam9pbignfCcpLnJlcGxhY2UoJysnLCAnJykgKyAnKVxcXFxiJywgJ2lnJyk7XG4gICAgICAgICAgICAgICAgbGV0IGFuZE1hdGNoZXMgPSBjaGVja2VkLmpvaW4oJywnKS5tYXRjaChhbmRQYXR0ZXJuKTtcbiAgICAgICAgICAgICAgICBsZXQgYW5kSXNNYXRjaGluZyA9IGFuZE1hdGNoZXMgIT09IG51bGwgJiYgYW5kTWF0Y2hlcy5sZW5ndGggPT09IGFuZC5sZW5ndGg7XG5cbiAgICAgICAgICAgICAgICBsZXQgYW5kbm90ID0gaXRlbS5tYXRjaCgvXFwtKFteXFwrXFwtXSspL2cpO1xuICAgICAgICAgICAgICAgIGxldCBhbmRub3RJc01hdGNoaW5nID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBpZiAoYW5kbm90ICE9PSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhbmRub3RQYXR0ZXJuID0gbmV3IFJlZ0V4cCgnXFxcXGIoJyArIGFuZG5vdC5qb2luKCd8JykucmVwbGFjZSgnLScsICcnKSArICcpXFxcXGInLCAnaWcnKTtcbiAgICAgICAgICAgICAgICAgICAgbGV0IGFuZG5vdE1hdGNoZXMgPSBjaGVja2VkLmpvaW4oJywnKS5tYXRjaChhbmRub3RQYXR0ZXJuKTtcbiAgICAgICAgICAgICAgICAgICAgYW5kbm90SXNNYXRjaGluZyA9ICEoYW5kbm90TWF0Y2hlcyAhPT0gbnVsbCAmJiBhbmRub3RNYXRjaGVzLmxlbmd0aCA+IDApO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChhbmRJc01hdGNoaW5nICYmIGFuZG5vdElzTWF0Y2hpbmcpIHtcbiAgICAgICAgICAgICAgICAgICAgc2hvdWxkU2hvdyA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEhpZGUgb3Igc2hvd1xuICAgICAgICAgICAgaWYgKHNob3VsZFNob3cgPT09IHRydWUpIHtcbiAgICAgICAgICAgICAgICAkKGVsZW1lbnQpLnNob3coKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICQoZWxlbWVudCkuaGlkZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuXG5cbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHJldHVybiBuZXcgQ2hlY2tib3hlcygpO1xuXG59KShqUXVlcnkpO1xuIiwiaW1wb3J0ICcuL0NvbnRlbnQvVG9kby5qcyc7XG5pbXBvcnQgJy4vQ29udGVudC9jaGVja2JveGVzLmpzJztcblxuLy8gUmVxdWlyZWQgc2VsZWN0b3JzXG5jb25zdCBTRUxFQ1RPUl9NT0RVTEFSSVRZX0dVSURFID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlJztcbmNvbnN0IFNFTEVDVE9SX1NFQ1RJT04gPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGVfX3NlY3Rpb24nO1xuY29uc3QgU0VMRUNUT1JfTkVYVCA9ICcuanMtbW9kdWxhcml0eS1ndWlkZV9fbmV4dCc7XG5jb25zdCBTRUxFQ1RPUl9QUkVWID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlX19wcmV2JztcbmNvbnN0IFNFTEVDVE9SX0FDQ09SRElPTl9UT0dHTEUgPSAnW2pzLWV4cGFuZC1idXR0b25dJztcblxuLy8gUmVxdWlyZWQgZGF0YS1hdHRyaWJ1dGVzXG5jb25zdCBBVFRSSUJVVEVfU1RFUCA9ICdkYXRhLWd1aWRlLXN0ZXAnO1xuXG4vKipcbiAqIENsaWNrIGhhbmRsZXIgZm9yIE5leHQgJiBQcmV2IGJ1dHRvbnMsXG4gKiB3aWxsIHRyYXZlcnNlIHVwIHRvIGZpbmQgY3VycmVudCwgcHJldmlvdXMgYW5kIHRoZSBuZXh0IHN0ZXAgdG8gc2ltdWxhdGUgYWNjb3JkaW9uIGNsaWNrXG4gKiBAcGFyYW0geyp9IGUgZXZlbnRcbiAqL1xuZnVuY3Rpb24gaGFuZGxlUHJldk5leHRDbGljayhlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgY29uc3QgcHJldk5leHRCdXR0b25FbGVtZW50ID0gZS50YXJnZXQ7XG4gICAgY29uc3QgaXNOZXh0ID0gZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFNFTEVDVE9SX05FWFQuc3Vic3RyaW5nKDEpKTtcblxuICAgIC8vIFRyYXZlcnNlIERPTSB1cHdhcmRzXG4gICAgY29uc3QgY3VycmVudEd1aWRlID0gcHJldk5leHRCdXR0b25FbGVtZW50Py5jbG9zZXN0KFNFTEVDVE9SX01PRFVMQVJJVFlfR1VJREUpO1xuICAgIGNvbnN0IGN1cnJlbnRTZWN0aW9uID0gcHJldk5leHRCdXR0b25FbGVtZW50Py5jbG9zZXN0KFNFTEVDVE9SX1NFQ1RJT04pO1xuICAgIGNvbnN0IGN1cnJlbnRTdGVwID0gcGFyc2VJbnQoY3VycmVudFNlY3Rpb24/LmdldEF0dHJpYnV0ZShBVFRSSUJVVEVfU1RFUCkgPz8gJy0xJyk7XG5cbiAgICBpZiAoY3VycmVudFN0ZXAgPiAwKSB7XG4gICAgICAgIGNvbnN0IHRhcmdldFN0ZXAgPSBpc05leHQgPyBjdXJyZW50U3RlcCArIDEgOiBjdXJyZW50U3RlcCAtIDE7XG4gICAgICAgIGNvbnN0IHRhcmdldFNlY3Rpb24gPSBjdXJyZW50R3VpZGU/LnF1ZXJ5U2VsZWN0b3IoYFske0FUVFJJQlVURV9TVEVQfT1cIiR7dGFyZ2V0U3RlcH1cIl1gKTtcbiAgICAgICAgY29uc3QgdGFyZ2V0VG9nZ2xlID0gdGFyZ2V0U2VjdGlvbj8ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9BQ0NPUkRJT05fVE9HR0xFKTtcblxuICAgICAgICBpZiAodGFyZ2V0VG9nZ2xlKSB7XG4gICAgICAgICAgICB0YXJnZXRUb2dnbGUuY2xpY2soKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbi8qKlxuICogU3Vic2NyaWJlIHByZXYvbmV4dCBidXR0b24gY2xpY2sgZXZlbnRcbiAqIEBwYXJhbSB7RWxlbWVudH0gd3JhcHBlckVsZW1lbnRcbiAqL1xuZnVuY3Rpb24gc3Vic2NyaWJlUHJldk5leHRCdXR0b25zKHdyYXBwZXJFbGVtZW50KSB7XG4gICAgY29uc3QgYnV0dG9ucyA9IFtcbiAgICAgICAgLi4ud3JhcHBlckVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChgJHtTRUxFQ1RPUl9TRUNUSU9OfSAke1NFTEVDVE9SX05FWFR9YCksXG4gICAgICAgIC4uLndyYXBwZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCR7U0VMRUNUT1JfU0VDVElPTn0gJHtTRUxFQ1RPUl9QUkVWfWApLFxuICAgIF07XG5cbiAgICBpZiAoYnV0dG9ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaChidXR0b25FbGVtZW50ID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBoYW5kbGVQcmV2TmV4dENsaWNrKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vKipcbiAqIFF1ZXJ5IGd1aWRlIG1vZHVsZXMgJiBpbml0aWFsaXplIHN0dWZmXG4gKi9cbmZ1bmN0aW9uIGluaXQoKSB7XG4gICAgY29uc3QgZ3VpZGVNb2R1bGVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChTRUxFQ1RPUl9NT0RVTEFSSVRZX0dVSURFKTtcblxuICAgIGlmIChndWlkZU1vZHVsZXMgJiYgZ3VpZGVNb2R1bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZ3VpZGVNb2R1bGVzLmZvckVhY2goc3Vic2NyaWJlUHJldk5leHRCdXR0b25zKTtcbiAgICB9XG59XG5cbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCk7Il0sInNvdXJjZVJvb3QiOiIifQ==