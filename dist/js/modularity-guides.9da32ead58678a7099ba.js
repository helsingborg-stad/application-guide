!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([,function(e,t,n){"use strict";function r(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,i){var a=e.apply(t,n);function c(e){r(a,o,i,c,u,"next",e)}function u(e){r(a,o,i,c,u,"throw",e)}c(void 0)}))}}function i(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.r(t);(function(e){var t={info:"c-notice--info",success:"c-notice--success",danger:"c-notice--danger",warning:"c-notice--warning"},n={};function r(n){var r,o;n.preventDefault();var a=n.target,c=a.closest(".js-modularity-guide-todos"),u=null==a||null===(r=a.querySelector('textarea[name="g-recaptcha-response"]'))||void 0===r?void 0:r.value,l=null==a||null===(o=a.querySelector('input[name="email"]'))||void 0===o?void 0:o.value;if(""===u)return!1;function d(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=c.querySelector(".js-modularity-guide-todos__notice"),a=o.querySelectorAll("c-icon"),u=o.classList,l=t[n];if(!1!==e){if(l&&!u.contains(l)&&(i(u).filter((function(e){return Object.values(t).includes(e)})).forEach((function(e){u.remove(e)})),u.add(l)),e.length>0){var d=o.querySelectorAll("span"),s=2===d.length?d[1]:d[0];s.innerHTML=e,r.length>0&&a&&(a.innerHTML=r),u.remove("u-display--none")}}else u.contains("u-display--none")||u.add("u-display--none")}d(!1);var s=null==c?void 0:c.querySelector(".js-modularity-guide-todos__table");if(s&&l&&ajaxurl){c.classList.toggle("is-loading");var f={action:"email_todo",checklist:function(e){var t,n,r=e.cloneNode(!0);null===(t=r=document.body.appendChild(r))||void 0===t||null===(n=t.querySelectorAll("tr"))||void 0===n||n.forEach((function(e){var t;(t=e).offsetWidth>0||t.offsetHeight>0||t.getClientRects().length>0||e.remove()}));var o=r.outerHTML;return r.remove(),encodeURI(o)}(s),email:l,captcha:u};e.post(ajaxurl,f,(function(e){c.classList.toggle("is-loading"),"success"==e?(d(guides.email_sent,"success","report"),setTimeout((function(){d(!1);var e=c.querySelector(".js-modularity-guide-todos__modal .c-modal__close");e&&e.click()}),2e3)):d(guides.email_failed,"danger","report")}))}}window.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".js-modularity-guide-todos");(null==e?void 0:e.length)>0&&e.forEach((function(e,t){!function(e,t){var r,i=null==e?void 0:e.querySelector(".js-modularity-guide-todos__grecaptcha"),a=null==i?void 0:i.getAttribute("data-sitekey");function c(e){return u.apply(this,arguments)}function u(){return(u=o(regeneratorRuntime.mark((function r(o){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:try{e.classList.toggle("is-disabled"),e.classList.contains("is-disabled")&&grecaptcha.reset(n["GreCaptchaWidget-".concat(t)])}catch(e){console.log(e)}case 1:case"end":return r.stop()}}),r)})))).apply(this,arguments)}(null===(r=grecaptcha)||void 0===r?void 0:r.render)&&i&&a&&(e.classList.toggle("is-disabled"),n["GreCaptchaWidget-".concat(t)]=grecaptcha.render(i,{sitekey:a,callback:c,"expired-callback":c}))}(e,t),function(e){var t;null==e||null===(t=e.querySelector(".js-modularity-guide-todos__form"))||void 0===t||t.addEventListener("submit",r)}(e)}))}))})(jQuery),function(e){function t(){this.handleEvents(),this.contentToggleEngine()}t.prototype.handleEvents=function(){e('input[type="checkbox"][data-mod-guide-relation]').on("change",(function(t){var n=e(this).data("mod-guide-relation");n=n.split(","),e.each(n,(function(t,n){var r=e('input[type="checkbox"][data-mod-guide-toggle-key="'+n+'"]');r.prop("checked",!r.prop("checked")).trigger("change")}))})),e("[data-mod-guide-toggle-key]").on("change",function(e){this.contentToggleEngine()}.bind(this))},t.prototype.contentToggleEngine=function(){var t=[];e("[data-mod-guide-toggle-key]").each((function(n,r){!0===e(r).prop("checked")&&t.push(e(r).attr("data-mod-guide-toggle-key"))})),e("[data-mod-guide-toggle-key-content]").each((function(n,r){var o=!1,i=e(r).attr("data-mod-guide-toggle-key-content");i=i.split(","),e.each(i,(function(e,n){var r=n.match(/(^|\+)([^\+\-]+)/g),i=new RegExp("\\b("+r.join("|").replace("+","")+")\\b","ig"),a=t.join(",").match(i),c=null!==a&&a.length===r.length,u=n.match(/\-([^\+\-]+)/g),l=!0;if(null!==u){var d=new RegExp("\\b("+u.join("|").replace("-","")+")\\b","ig"),s=t.join(",").match(d);l=!(null!==s&&s.length>0)}c&&l&&(o=!0)})),!0!==o?e(r).hide():e(r).show()}))},new t}(jQuery);function c(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e){var t;e.preventDefault();var n=e.target,r=e.target.classList.contains(".js-modularity-guide__next".substring(1)),o=null==n?void 0:n.closest(".js-modularity-guide"),i=null==n?void 0:n.closest(".js-modularity-guide__section"),a=parseInt(null!==(t=null==i?void 0:i.getAttribute("data-guide-step"))&&void 0!==t?t:"-1");if(a>0){var c=r?a+1:a-1,u=null==o?void 0:o.querySelector("[".concat("data-guide-step",'="').concat(c,'"]')),l=null==u?void 0:u.querySelector("[js-expand-button]");l&&l.click()}}function d(e){var t=[].concat(c(e.querySelectorAll("".concat(".js-modularity-guide__section"," ").concat(".js-modularity-guide__next"))),c(e.querySelectorAll("".concat(".js-modularity-guide__section"," ").concat(".js-modularity-guide__prev"))));t.length>0&&t.forEach((function(e){e.addEventListener("click",l)}))}window.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".js-modularity-guide");e&&e.length>0&&e.forEach(d)}))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc291cmNlL2pzL0NvbnRlbnQvVG9kby5qcyIsIndlYnBhY2s6Ly8vLi9zb3VyY2UvanMvQ29udGVudC9jaGVja2JveGVzLmpzIiwid2VicGFjazovLy8uL3NvdXJjZS9qcy9tb2R1bGFyaXR5LWd1aWRlcy5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIiQiLCJOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FUyIsImluZm8iLCJzdWNjZXNzIiwiZGFuZ2VyIiwid2FybmluZyIsIlJFQ0FQVENIQV9XSURHRVRTIiwiaGFuZGxlU3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiY3VycmVudEZvcm0iLCJ0YXJnZXQiLCJjdXJyZW50U2VjdGlvbiIsImNsb3Nlc3QiLCJyZWNhcHRjaGEiLCJxdWVyeVNlbGVjdG9yIiwiZW1haWwiLCJzZXROb3RpY2UiLCJ0ZXh0IiwibGV2ZWwiLCJpY29uIiwibm90aWNlRWxlbWVudCIsIm5vdGljZUljb25FbGVtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIm5vdGljZUNsYXNzTGlzdCIsImNsYXNzTGlzdCIsIm5vdGljZUxldmVsQ2xhc3NOYW1lIiwiY29udGFpbnMiLCJmaWx0ZXIiLCJjbGFzc05hbWUiLCJ2YWx1ZXMiLCJpbmNsdWRlcyIsImZvckVhY2giLCJyZW1vdmUiLCJhZGQiLCJsZW5ndGgiLCJzcGFuRWxlbWVudHMiLCJ0ZXh0U3BhbiIsImlubmVySFRNTCIsInRvZG9UYWJsZSIsImFqYXh1cmwiLCJ0b2dnbGUiLCJkYXRhIiwiYWN0aW9uIiwiY2hlY2tsaXN0IiwiY2xvbmVOb2RlIiwiZG9jdW1lbnQiLCJib2R5IiwiYXBwZW5kQ2hpbGQiLCJyb3ciLCJlbGVtIiwib2Zmc2V0V2lkdGgiLCJvZmZzZXRIZWlnaHQiLCJnZXRDbGllbnRSZWN0cyIsImNoZWNrbGlzdEhUTUwiLCJvdXRlckhUTUwiLCJlbmNvZGVVUkkiLCJnZXRDaGVja0xpc3QiLCJjYXB0Y2hhIiwicG9zdCIsInJlc3BvbnNlIiwiZ3VpZGVzIiwiZW1haWxfc2VudCIsInNldFRpbWVvdXQiLCJjbG9zZU1vZGFsIiwiY2xpY2siLCJlbWFpbF9mYWlsZWQiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwidG9kb1NlY3Rpb25zIiwidG9kb1NlY3Rpb24iLCJpbmRleCIsInJlY2FwdGNoYUNvbnRhaW5lciIsInJlY2FwdGNoYVNpdGVLZXkiLCJnZXRBdHRyaWJ1dGUiLCJoYW5kbGVSZWNhcHRjaGEiLCJncmVjYXB0Y2hhIiwicmVzZXQiLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJyZW5kZXIiLCJzaXRla2V5IiwiY2FsbGJhY2siLCJyZW5kZXJSZWNhcHRjaGEiLCJzdWJzY3JpYmVGb3JtIiwialF1ZXJ5IiwiQ2hlY2tib3hlcyIsInRoaXMiLCJoYW5kbGVFdmVudHMiLCJjb250ZW50VG9nZ2xlRW5naW5lIiwib24iLCJyZWxhdGlvbnMiLCJzcGxpdCIsImVhY2giLCJpdGVtIiwiJGNiIiwicHJvcCIsInRyaWdnZXIiLCJjaGVja2VkIiwiZWxlbWVudCIsInB1c2giLCJhdHRyIiwic2hvdWxkU2hvdyIsImNvbmRpdGlvbnMiLCJhbmQiLCJtYXRjaCIsImFuZFBhdHRlcm4iLCJSZWdFeHAiLCJqb2luIiwicmVwbGFjZSIsImFuZE1hdGNoZXMiLCJhbmRJc01hdGNoaW5nIiwiYW5kbm90IiwiYW5kbm90SXNNYXRjaGluZyIsImFuZG5vdFBhdHRlcm4iLCJhbmRub3RNYXRjaGVzIiwiaGlkZSIsInNob3ciLCJoYW5kbGVQcmV2TmV4dENsaWNrIiwicHJldk5leHRCdXR0b25FbGVtZW50IiwiaXNOZXh0Iiwic3Vic3RyaW5nIiwiY3VycmVudEd1aWRlIiwiY3VycmVudFN0ZXAiLCJwYXJzZUludCIsInRhcmdldFN0ZXAiLCJ0YXJnZXRTZWN0aW9uIiwidGFyZ2V0VG9nZ2xlIiwic3Vic2NyaWJlUHJldk5leHRCdXR0b25zIiwid3JhcHBlckVsZW1lbnQiLCJidXR0b25zIiwiYnV0dG9uRWxlbWVudCIsImd1aWRlTW9kdWxlcyJdLCJtYXBwaW5ncyI6ImFBQ0UsSUFBSUEsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVUMsUUFHbkMsSUFBSUMsRUFBU0osRUFBaUJFLEdBQVksQ0FDekNHLEVBQUdILEVBQ0hJLEdBQUcsRUFDSEgsUUFBUyxJQVVWLE9BTkFJLEVBQVFMLEdBQVVNLEtBQUtKLEVBQU9ELFFBQVNDLEVBQVFBLEVBQU9ELFFBQVNGLEdBRy9ERyxFQUFPRSxHQUFJLEVBR0pGLEVBQU9ELFFBS2ZGLEVBQW9CUSxFQUFJRixFQUd4Qk4sRUFBb0JTLEVBQUlWLEVBR3hCQyxFQUFvQlUsRUFBSSxTQUFTUixFQUFTUyxFQUFNQyxHQUMzQ1osRUFBb0JhLEVBQUVYLEVBQVNTLElBQ2xDRyxPQUFPQyxlQUFlYixFQUFTUyxFQUFNLENBQUVLLFlBQVksRUFBTUMsSUFBS0wsS0FLaEVaLEVBQW9Ca0IsRUFBSSxTQUFTaEIsR0FDWCxvQkFBWGlCLFFBQTBCQSxPQUFPQyxhQUMxQ04sT0FBT0MsZUFBZWIsRUFBU2lCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZWIsRUFBUyxhQUFjLENBQUVtQixPQUFPLEtBUXZEckIsRUFBb0JzQixFQUFJLFNBQVNELEVBQU9FLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUYsRUFBUXJCLEVBQW9CcUIsSUFDL0IsRUFBUEUsRUFBVSxPQUFPRixFQUNwQixHQUFXLEVBQVBFLEdBQThCLGlCQUFWRixHQUFzQkEsR0FBU0EsRUFBTUcsV0FBWSxPQUFPSCxFQUNoRixJQUFJSSxFQUFLWCxPQUFPWSxPQUFPLE1BR3ZCLEdBRkExQixFQUFvQmtCLEVBQUVPLEdBQ3RCWCxPQUFPQyxlQUFlVSxFQUFJLFVBQVcsQ0FBRVQsWUFBWSxFQUFNSyxNQUFPQSxJQUN0RCxFQUFQRSxHQUE0QixpQkFBVEYsRUFBbUIsSUFBSSxJQUFJTSxLQUFPTixFQUFPckIsRUFBb0JVLEVBQUVlLEVBQUlFLEVBQUssU0FBU0EsR0FBTyxPQUFPTixFQUFNTSxJQUFRQyxLQUFLLEtBQU1ELElBQzlJLE9BQU9GLEdBSVJ6QixFQUFvQjZCLEVBQUksU0FBUzFCLEdBQ2hDLElBQUlTLEVBQVNULEdBQVVBLEVBQU9xQixXQUM3QixXQUF3QixPQUFPckIsRUFBZ0IsU0FDL0MsV0FBOEIsT0FBT0EsR0FFdEMsT0FEQUgsRUFBb0JVLEVBQUVFLEVBQVEsSUFBS0EsR0FDNUJBLEdBSVJaLEVBQW9CYSxFQUFJLFNBQVNpQixFQUFRQyxHQUFZLE9BQU9qQixPQUFPa0IsVUFBVUMsZUFBZTFCLEtBQUt1QixFQUFRQyxJQUd6Ry9CLEVBQW9Ca0MsRUFBSSxHQUlqQmxDLEVBQW9CQSxFQUFvQm1DLEVBQUksRyw4a0NDbEZ0QyxTQUFXQyxHQUN0QixJQVNNQyxFQUEwQixDQUM1QkMsS0FBTSxpQkFDTkMsUUFBUyxvQkFDVEMsT0FBUSxtQkFDUkMsUUFBUyxxQkFHVEMsRUFBb0IsR0FtQ3hCLFNBQVNDLEVBQWFDLEdBQUcsUUFDckJBLEVBQUVDLGlCQUVGLElBQU1DLEVBQWNGLEVBQUVHLE9BQ2hCQyxFQUFpQkYsRUFBWUcsUUF2RFIsOEJBd0RyQkMsRUFBWUosU0FBSCxVQUFHQSxFQUFhSyxjQWxERixnREFrRGQsYUFBRyxFQUFzRDlCLE1BQ2xFK0IsRUFBUU4sU0FBSCxVQUFHQSxFQUFhSyxjQWxERiw4QkFrRGQsYUFBRyxFQUFrRDlCLE1BRWhFLEdBQWtCLEtBQWQ2QixFQUNBLE9BQU8sRUFVWCxTQUFTRyxFQUFVQyxHQUFpQyxJQUEzQkMsRUFBMkIsdURBQW5CLE9BQVFDLEVBQVcsdURBQUosR0FDdENDLEVBQWdCVCxFQUFlRyxjQXBFaEIsc0NBcUVmTyxFQUFvQkQsRUFBY0UsaUJBQWlCLFVBQ25EQyxFQUFrQkgsRUFBY0ksVUFDaENDLEVBQXVCekIsRUFBd0JrQixHQUVyRCxJQUFhLElBQVRELEdBcUJKLEdBYklRLElBQXlCRixFQUFnQkcsU0FBU0QsS0FFbEQsRUFBSUYsR0FDSEksUUFBTyxTQUFBQyxHQUFTLE9BQ2JuRCxPQUFPb0QsT0FBTzdCLEdBQXlCOEIsU0FBU0YsTUFFbkRHLFNBQVEsU0FBQUgsR0FDTEwsRUFBZ0JTLE9BQU9KLE1BRzNCTCxFQUFnQlUsSUFBSVIsSUFHcEJSLEVBQUtpQixPQUFTLEVBQUcsQ0FDakIsSUFBTUMsRUFBZWYsRUFBY0UsaUJBQWlCLFFBQzlDYyxFQUFtQyxJQUF4QkQsRUFBYUQsT0FBZUMsRUFBYSxHQUFLQSxFQUFhLEdBQzVFQyxFQUFTQyxVQUFZcEIsRUFHakJFLEVBQUtlLE9BQVMsR0FBS2IsSUFDbkJBLEVBQWtCZ0IsVUFBWWxCLEdBR2xDSSxFQUFnQlMsT0FBTyx5QkE5QmxCVCxFQUFnQkcsU0FBUyxvQkFDMUJILEVBQWdCVSxJQUFJLG1CQWlDaENqQixHQUFVLEdBRVYsSUFBTXNCLEVBQVkzQixhQUFILEVBQUdBLEVBQWdCRyxjQTdHZixxQ0ErR25CLEdBQUl3QixHQUFhdkIsR0FBU3dCLFFBQVMsQ0FDL0I1QixFQUFlYSxVQUFVZ0IsT0FBTyxjQUVoQyxJQUNNQyxFQUFPLENBQ1RDLE9BQVEsYUFDUkMsVUEzRlosU0FBc0JMLEdBQVcsUUFDekJLLEVBQVlMLEVBQVVNLFdBQVUsR0FJM0IsUUFBVCxFQUhBRCxFQUFZRSxTQUFTQyxLQUFLQyxZQUFZSixVQUd0QyxtQkFBV3JCLGlCQUFpQixhQUE1QixTQUFtQ1MsU0FBUSxTQUFBaUIsR0FaN0IsSUFBQ0MsS0FhR0QsR0FiWUUsWUFBYyxHQUFLRCxFQUFLRSxhQUFlLEdBQUtGLEVBQUtHLGlCQUFpQmxCLE9BQVMsR0FnQnJHYyxFQUFJaEIsWUFHUixJQUFJcUIsRUFBZ0JWLEVBQVVXLFVBRTlCLE9BREFYLEVBQVVYLFNBQ0h1QixVQUFVRixHQTBFS0csQ0FBYWxCLEdBSTNCdkIsTUFBT0EsRUFDUDBDLFFBQVM1QyxHQUdiZCxFQUFFMkQsS0FBS25CLFFBQVNFLEdBQU0sU0FBVWtCLEdBQzVCaEQsRUFBZWEsVUFBVWdCLE9BQU8sY0FDaEIsV0FBWm1CLEdBQ0EzQyxFQUFVNEMsT0FBT0MsV0FBWSxVQUFXLFVBQ3hDQyxZQUFXLFdBQ1A5QyxHQUFVLEdBQ1YsSUFBTStDLEVBQWFwRCxFQUFlRyxjQWxJbEIscURBbUlaaUQsR0FDQUEsRUFBV0MsVUFHaEIsTUFHSGhELEVBQVU0QyxPQUFPSyxhQUFjLFNBQVUsY0FtRHpEQyxPQUFPQyxpQkFBaUIsb0JBVnhCLFdBQ0ksSUFBTUMsRUFBZXZCLFNBQVN2QixpQkF0TEgsK0JBdUx2QjhDLGFBQUEsRUFBQUEsRUFBY2xDLFFBQVMsR0FDdkJrQyxFQUFhckMsU0FBUSxTQUFDc0MsRUFBYUMsSUFoQzNDLFNBQXlCRCxFQUFhQyxHQUFPLE1BQ25DQyxFQUFxQkYsYUFBSCxFQUFHQSxFQUFhdkQsY0FwSk4sMENBcUo1QjBELEVBQW1CRCxhQUFILEVBQUdBLEVBQW9CRSxhQUFhLGdCQUZqQixTQUkxQkMsRUFKMEIsbUZBSXpDLFdBQStCbkUsR0FBL0IsZ0ZBQ0ksSUFDSThELEVBQVk3QyxVQUFVZ0IsT0FBTyxlQUN6QjZCLEVBQVk3QyxVQUFVRSxTQUFTLGdCQUMvQmlELFdBQVdDLE1BQU12RSxFQUFrQixvQkFBRCxPQUFxQmlFLEtBRTdELE1BQU1PLEdBQ0pDLFFBQVFDLElBQUlGLEdBUHBCLDRDQUp5Qyx1QkFnQjNCLFFBQVYsRUFBQUYsa0JBQUEsZUFBWUssU0FBVVQsR0FBc0JDLElBQzVDSCxFQUFZN0MsVUFBVWdCLE9BQU8sZUFDN0JuQyxFQUFrQixvQkFBRCxPQUFxQmlFLElBQVdLLFdBQVdLLE9BQU9ULEVBQW9CLENBQ25GVSxRQUFTVCxFQUNUVSxTQUFVUixFQUNWLG1CQUFvQkEsS0FZcEJTLENBQWdCZCxFQUFhQyxHQXJDekMsU0FBdUJELEdBQWEsTUFDaENBLFNBQUEsVUFBQUEsRUFBYXZELGNBcEpLLDJDQW9KbEIsU0FBMkNxRCxpQkFBaUIsU0FBVTdELEdBcUM5RDhFLENBQWNmLFVBM0xmLENBaU1aZ0IsUUNqTVksU0FBV3RGLEdBRXRCLFNBQVN1RixJQUNMQyxLQUFLQyxlQUNMRCxLQUFLRSxzQkFHVEgsRUFBVzNGLFVBQVU2RixhQUFlLFdBRWhDekYsRUFBRSxtREFBbUQyRixHQUFHLFVBQVUsU0FBVW5GLEdBRXhFLElBQUlvRixFQUFZNUYsRUFBRXdGLE1BQU05QyxLQUFLLHNCQUM3QmtELEVBQVlBLEVBQVVDLE1BQU0sS0FFNUI3RixFQUFFOEYsS0FBS0YsR0FBVyxTQUFVckIsRUFBT3dCLEdBQy9CLElBQUlDLEVBQU1oRyxFQUFFLHFEQUF1RCtGLEVBQU8sTUFDMUVDLEVBQUlDLEtBQUssV0FBWUQsRUFBSUMsS0FBSyxZQUFZQyxRQUFRLGdCQUkxRGxHLEVBQUUsK0JBQStCMkYsR0FBRyxTQUFVLFNBQVVuRixHQUNwRGdGLEtBQUtFLHVCQUNQbEcsS0FBS2dHLFFBS1hELEVBQVczRixVQUFVOEYsb0JBQXNCLFdBRXZDLElBQUlTLEVBQVUsR0FDSW5HLEVBQUUsK0JBRVI4RixNQUFLLFNBQVV2QixFQUFPNkIsSUFDSyxJQUEvQnBHLEVBQUVvRyxHQUFTSCxLQUFLLFlBSXBCRSxFQUFRRSxLQUFLckcsRUFBRW9HLEdBQVNFLEtBQUssaUNBTWpDdEcsRUFBRSx1Q0FBdUM4RixNQUFLLFNBQVV2QixFQUFPNkIsR0FDM0QsSUFBSUcsR0FBYSxFQUNiQyxFQUFheEcsRUFBRW9HLEdBQVNFLEtBQUsscUNBQ2pDRSxFQUFhQSxFQUFXWCxNQUFNLEtBRzlCN0YsRUFBRThGLEtBQUtVLEdBQVksU0FBVWpDLEVBQU93QixHQUNoQyxJQUFJVSxFQUFNVixFQUFLVyxNQUFNLHFCQUNqQkMsRUFBYSxJQUFJQyxPQUFPLE9BQVNILEVBQUlJLEtBQUssS0FBS0MsUUFBUSxJQUFLLElBQU0sT0FBUSxNQUMxRUMsRUFBYVosRUFBUVUsS0FBSyxLQUFLSCxNQUFNQyxHQUNyQ0ssRUFBK0IsT0FBZkQsR0FBdUJBLEVBQVc1RSxTQUFXc0UsRUFBSXRFLE9BRWpFOEUsRUFBU2xCLEVBQUtXLE1BQU0saUJBQ3BCUSxHQUFtQixFQUN2QixHQUFlLE9BQVhELEVBQWlCLENBQ2pCLElBQUlFLEVBQWdCLElBQUlQLE9BQU8sT0FBU0ssRUFBT0osS0FBSyxLQUFLQyxRQUFRLElBQUssSUFBTSxPQUFRLE1BQ2hGTSxFQUFnQmpCLEVBQVFVLEtBQUssS0FBS0gsTUFBTVMsR0FDNUNELElBQXVDLE9BQWxCRSxHQUEwQkEsRUFBY2pGLE9BQVMsR0FHdEU2RSxHQUFpQkUsSUFDakJYLEdBQWEsT0FLRixJQUFmQSxFQUtKdkcsRUFBRW9HLEdBQVNpQixPQUpQckgsRUFBRW9HLEdBQVNrQixXQVdoQixJQUFJL0IsRUFqRkEsQ0FtRlpELFEsMHVCQ2pFSCxTQUFTaUMsRUFBb0IvRyxHQUFHLE1BQzVCQSxFQUFFQyxpQkFFRixJQUFNK0csRUFBd0JoSCxFQUFFRyxPQUMxQjhHLEVBQVNqSCxFQUFFRyxPQUFPYyxVQUFVRSxTQWhCaEIsNkJBZ0J1QytGLFVBQVUsSUFHN0RDLEVBQWVILGFBQUgsRUFBR0EsRUFBdUIzRyxRQXJCZCx3QkFzQnhCRCxFQUFpQjRHLGFBQUgsRUFBR0EsRUFBdUIzRyxRQXJCekIsaUNBc0JmK0csRUFBY0MsU0FBUSxVQUFDakgsYUFBRCxFQUFDQSxFQUFnQjhELGFBaEIxQiwwQkFnQlMsUUFBaUQsTUFFN0UsR0FBSWtELEVBQWMsRUFBRyxDQUNqQixJQUFNRSxFQUFhTCxFQUFTRyxFQUFjLEVBQUlBLEVBQWMsRUFDdERHLEVBQWdCSixhQUFILEVBQUdBLEVBQWM1RyxjQUFkLFdBcEJQLGtCQW9CTyxhQUFtRCtHLEVBQW5ELE9BQ2hCRSxFQUFlRCxhQUFILEVBQUdBLEVBQWVoSCxjQXhCVixzQkEwQnRCaUgsR0FDQUEsRUFBYS9ELFNBU3pCLFNBQVNnRSxFQUF5QkMsR0FDOUIsSUFBTUMsRUFBVSxHQUFILFNBQ05ELEVBQWUzRyxpQkFBZixVQXpDYyxnQ0F5Q2QsWUF4Q1csZ0NBdUNMLEVBRU4yRyxFQUFlM0csaUJBQWYsVUExQ2MsZ0NBMENkLFlBeENXLGlDQTJDZDRHLEVBQVFoRyxPQUFTLEdBQ2pCZ0csRUFBUW5HLFNBQVEsU0FBQW9HLEdBQ1pBLEVBQWNoRSxpQkFBaUIsUUFBU21ELE1BZ0JwRHBELE9BQU9DLGlCQUFpQixvQkFSeEIsV0FDSSxJQUFNaUUsRUFBZXZGLFNBQVN2QixpQkF6REEsd0JBMkQxQjhHLEdBQWdCQSxFQUFhbEcsT0FBUyxHQUN0Q2tHLEVBQWFyRyxRQUFRaUciLCJmaWxlIjoianMvbW9kdWxhcml0eS1ndWlkZXMuOWRhMzJlYWQ1ODY3OGE3MDk5YmEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJleHBvcnQgZGVmYXVsdCAoZnVuY3Rpb24gKCQpIHtcbiAgICBjb25zdCBTRUxFQ1RPUl9UT0RPU19XUkFQUEVSID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlLXRvZG9zJztcbiAgICBjb25zdCBTRUxFQ1RPUl9GT1JNID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlLXRvZG9zX19mb3JtJztcbiAgICBjb25zdCBTRUxFQ1RPUl9NT0RBTF9DTE9TRV9CVVRUT04gPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGUtdG9kb3NfX21vZGFsIC5jLW1vZGFsX19jbG9zZSc7XG4gICAgY29uc3QgU0VMRUNUT1JfRk9STV9OT1RJQ0UgPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGUtdG9kb3NfX25vdGljZSc7XG4gICAgY29uc3QgU0VMRUNUT1JfVEFCTEUgPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGUtdG9kb3NfX3RhYmxlJztcbiAgICBjb25zdCBTRUxFQ1RPUl9HUkVDQVBUQ0hBX0NPTlRBSU5FUiA9ICcuanMtbW9kdWxhcml0eS1ndWlkZS10b2Rvc19fZ3JlY2FwdGNoYSc7XG4gICAgY29uc3QgU0VMRUNUT1JfSU5QVVRfUkVDQVBUQ0hBID0gJ3RleHRhcmVhW25hbWU9XCJnLXJlY2FwdGNoYS1yZXNwb25zZVwiXSc7XG4gICAgY29uc3QgU0VMRUNUT1JfSU5QVVRfRU1BSUwgPSAnaW5wdXRbbmFtZT1cImVtYWlsXCJdJztcbiAgICBcbiAgICBjb25zdCBOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FUyA9IHtcbiAgICAgICAgaW5mbzogJ2Mtbm90aWNlLS1pbmZvJywgXG4gICAgICAgIHN1Y2Nlc3M6ICdjLW5vdGljZS0tc3VjY2VzcycsIFxuICAgICAgICBkYW5nZXI6ICdjLW5vdGljZS0tZGFuZ2VyJywgXG4gICAgICAgIHdhcm5pbmc6ICdjLW5vdGljZS0td2FybmluZydcbiAgICB9O1xuICAgIFxuICAgIGxldCBSRUNBUFRDSEFfV0lER0VUUyA9IHt9OyAgICBcblxuICAgIC8qKlxuICAgICAqIFV0aWxpdHkgdG8gY2hlY2sgaWYgZWxlbWVudCBpcyB2aXNpYmxlIG9yIG5vdFxuICAgICAqIEBwYXJhbSB7Kn0gZWxlbSBcbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBjb25zdCBpc1Zpc2libGUgPSAoZWxlbSkgPT4gKGVsZW0ub2Zmc2V0V2lkdGggPiAwIHx8IGVsZW0ub2Zmc2V0SGVpZ2h0ID4gMCB8fCBlbGVtLmdldENsaWVudFJlY3RzKCkubGVuZ3RoID4gMCk7XG5cbiAgICAvKipcbiAgICAgKiBFeHRyYWN0IGNoZWNrbGlzdCBodG1sIGZyb20gdG9kbyB0YWJsZVxuICAgICAqIEBwYXJhbSB7Kn0gdG9kb1RhYmxlIFxuICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGh0bWwgd2l0aCB2aXNpYmxlIGNoZWNrbGlzdCBpdGVtc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGdldENoZWNrTGlzdCh0b2RvVGFibGUpIHtcbiAgICAgICAgbGV0IGNoZWNrbGlzdCA9IHRvZG9UYWJsZS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICAgIGNoZWNrbGlzdCA9IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoY2hlY2tsaXN0KTtcbiAgICBcbiAgICAgICAgLy8gUmVtb3ZlIG5vdCB2aXNpYmxlIHJvd3NcbiAgICAgICAgY2hlY2tsaXN0Py5xdWVyeVNlbGVjdG9yQWxsKCd0cicpPy5mb3JFYWNoKHJvdyA9PiB7XG4gICAgICAgICAgICBpZiAoaXNWaXNpYmxlKHJvdykpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByb3cucmVtb3ZlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgbGV0IGNoZWNrbGlzdEhUTUwgPSBjaGVja2xpc3Qub3V0ZXJIVE1MO1xuICAgICAgICBjaGVja2xpc3QucmVtb3ZlKCk7XG4gICAgICAgIHJldHVybiBlbmNvZGVVUkkoY2hlY2tsaXN0SFRNTCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2VuZCBjaGVja2xpc3QgZW1haWwgdGhyb3VnaCB3b3JkcHJlc3Mgb24gc3VibWl0XG4gICAgICogQHBhcmFtIHsqfSBlIFxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGhhbmRsZVN1Ym1pdChlKSB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBcbiAgICAgICAgY29uc3QgY3VycmVudEZvcm0gPSBlLnRhcmdldDtcbiAgICAgICAgY29uc3QgY3VycmVudFNlY3Rpb24gPSBjdXJyZW50Rm9ybS5jbG9zZXN0KFNFTEVDVE9SX1RPRE9TX1dSQVBQRVIpO1xuICAgICAgICBjb25zdCByZWNhcHRjaGEgPSBjdXJyZW50Rm9ybT8ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9JTlBVVF9SRUNBUFRDSEEpPy52YWx1ZTtcbiAgICAgICAgY29uc3QgZW1haWwgPSBjdXJyZW50Rm9ybT8ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9JTlBVVF9FTUFJTCk/LnZhbHVlO1xuICAgIFxuICAgICAgICBpZiAocmVjYXB0Y2hhID09PSAnJykge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBEaXNwbGF5IG9yIGhpZGUgZm9ybSBub3RpY2VcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmcvYm9vbGVhbn0gdGV4dCBub3RpY2UgY29udGVudCwgc2V0IHRvIGZhbHNlIHRvIGhpZGUgbm90aWNlIFxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gbGV2ZWwgIG5vdGljZSBsZXZlbCAtIGluZm8sIGRhbmdlciwgd2FybmluZywgc3VjY2Vzc1xuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gaWNvbiBtYXRlcmlhbCBpY29uIG5hbWVcbiAgICAgICAgICogQHJldHVybnNcbiAgICAgICAgICovXG4gICAgICAgIGZ1bmN0aW9uIHNldE5vdGljZSh0ZXh0LCBsZXZlbCA9ICdpbmZvJywgaWNvbiA9ICcnKSB7XG4gICAgICAgICAgICBjb25zdCBub3RpY2VFbGVtZW50ID0gY3VycmVudFNlY3Rpb24ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9GT1JNX05PVElDRSk7XG4gICAgICAgICAgICBjb25zdCBub3RpY2VJY29uRWxlbWVudCA9IG5vdGljZUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCgnYy1pY29uJyk7XG4gICAgICAgICAgICBjb25zdCBub3RpY2VDbGFzc0xpc3QgPSBub3RpY2VFbGVtZW50LmNsYXNzTGlzdDtcbiAgICAgICAgICAgIGNvbnN0IG5vdGljZUxldmVsQ2xhc3NOYW1lID0gTk9USUNFX0xFVkVMX0NMQVNTTkFNRVNbbGV2ZWxdO1xuXG4gICAgICAgICAgICBpZiAodGV4dCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICBpZiAoIW5vdGljZUNsYXNzTGlzdC5jb250YWlucygndS1kaXNwbGF5LS1ub25lJykpIHtcbiAgICAgICAgICAgICAgICAgICAgbm90aWNlQ2xhc3NMaXN0LmFkZCgndS1kaXNwbGF5LS1ub25lJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAobm90aWNlTGV2ZWxDbGFzc05hbWUgJiYgIW5vdGljZUNsYXNzTGlzdC5jb250YWlucyhub3RpY2VMZXZlbENsYXNzTmFtZSkpIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBbLi4ubm90aWNlQ2xhc3NMaXN0XVxuICAgICAgICAgICAgICAgIC5maWx0ZXIoY2xhc3NOYW1lID0+IChcbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LnZhbHVlcyhOT1RJQ0VfTEVWRUxfQ0xBU1NOQU1FUykuaW5jbHVkZXMoY2xhc3NOYW1lKVxuICAgICAgICAgICAgICAgICkpXG4gICAgICAgICAgICAgICAgLmZvckVhY2goY2xhc3NOYW1lID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbm90aWNlQ2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgbm90aWNlQ2xhc3NMaXN0LmFkZChub3RpY2VMZXZlbENsYXNzTmFtZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0ZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBzcGFuRWxlbWVudHMgPSBub3RpY2VFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ3NwYW4nKTtcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXh0U3BhbiA9IHNwYW5FbGVtZW50cy5sZW5ndGggPT09IDIgPyBzcGFuRWxlbWVudHNbMV0gOiBzcGFuRWxlbWVudHNbMF07XG4gICAgICAgICAgICAgICAgdGV4dFNwYW4uaW5uZXJIVE1MID0gdGV4dDtcblxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChpY29uLmxlbmd0aCA+IDAgJiYgbm90aWNlSWNvbkVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgbm90aWNlSWNvbkVsZW1lbnQuaW5uZXJIVE1MID0gaWNvbjtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBub3RpY2VDbGFzc0xpc3QucmVtb3ZlKCd1LWRpc3BsYXktLW5vbmUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0Tm90aWNlKGZhbHNlKTtcblxuICAgICAgICBjb25zdCB0b2RvVGFibGUgPSBjdXJyZW50U2VjdGlvbj8ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9UQUJMRSk7XG4gICAgXG4gICAgICAgIGlmICh0b2RvVGFibGUgJiYgZW1haWwgJiYgYWpheHVybCkge1xuICAgICAgICAgICAgY3VycmVudFNlY3Rpb24uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtbG9hZGluZycpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBjaGVja2xpc3QgPSBnZXRDaGVja0xpc3QodG9kb1RhYmxlKTsgXG4gICAgICAgICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICAgICAgICAgIGFjdGlvbjogJ2VtYWlsX3RvZG8nLFxuICAgICAgICAgICAgICAgIGNoZWNrbGlzdDogY2hlY2tsaXN0LFxuICAgICAgICAgICAgICAgIGVtYWlsOiBlbWFpbCxcbiAgICAgICAgICAgICAgICBjYXB0Y2hhOiByZWNhcHRjaGFcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICQucG9zdChhamF4dXJsLCBkYXRhLCBmdW5jdGlvbiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50U2VjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1sb2FkaW5nJyk7XG4gICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlID09ICdzdWNjZXNzJykge1xuICAgICAgICAgICAgICAgICAgICBzZXROb3RpY2UoZ3VpZGVzLmVtYWlsX3NlbnQsICdzdWNjZXNzJywgJ3JlcG9ydCcpO1xuICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgeyBcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldE5vdGljZShmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbG9zZU1vZGFsID0gY3VycmVudFNlY3Rpb24ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9NT0RBTF9DTE9TRV9CVVRUT04pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNsb3NlTW9kYWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbG9zZU1vZGFsLmNsaWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSwgMjAwMCk7XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBzZXROb3RpY2UoZ3VpZGVzLmVtYWlsX2ZhaWxlZCwgJ2RhbmdlcicsICdyZXBvcnQnKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgXG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIHN1YnNjcmliZUZvcm0odG9kb1NlY3Rpb24pIHtcbiAgICAgICAgdG9kb1NlY3Rpb24/LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfRk9STSk/LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIGhhbmRsZVN1Ym1pdCk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcmVuZGVyUmVjYXB0Y2hhKHRvZG9TZWN0aW9uLCBpbmRleCkge1xuICAgICAgICBjb25zdCByZWNhcHRjaGFDb250YWluZXIgPSB0b2RvU2VjdGlvbj8ucXVlcnlTZWxlY3RvcihTRUxFQ1RPUl9HUkVDQVBUQ0hBX0NPTlRBSU5FUik7XG4gICAgICAgIGNvbnN0IHJlY2FwdGNoYVNpdGVLZXkgPSByZWNhcHRjaGFDb250YWluZXI/LmdldEF0dHJpYnV0ZSgnZGF0YS1zaXRla2V5Jyk7XG5cbiAgICAgICAgYXN5bmMgZnVuY3Rpb24gaGFuZGxlUmVjYXB0Y2hhKGUpIHtcbiAgICAgICAgICAgIHRyeSB7ICAgICBcbiAgICAgICAgICAgICAgICB0b2RvU2VjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdpcy1kaXNhYmxlZCcpOyAgIFxuICAgICAgICAgICAgICAgIGlmICh0b2RvU2VjdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2lzLWRpc2FibGVkJykpIHtcbiAgICAgICAgICAgICAgICAgICAgZ3JlY2FwdGNoYS5yZXNldChSRUNBUFRDSEFfV0lER0VUU1tgR3JlQ2FwdGNoYVdpZGdldC0ke2luZGV4fWBdKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgaWYgKGdyZWNhcHRjaGE/LnJlbmRlciAmJiByZWNhcHRjaGFDb250YWluZXIgJiYgcmVjYXB0Y2hhU2l0ZUtleSkge1xuICAgICAgICAgICAgdG9kb1NlY3Rpb24uY2xhc3NMaXN0LnRvZ2dsZSgnaXMtZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIFJFQ0FQVENIQV9XSURHRVRTW2BHcmVDYXB0Y2hhV2lkZ2V0LSR7aW5kZXh9YF0gPSBncmVjYXB0Y2hhLnJlbmRlcihyZWNhcHRjaGFDb250YWluZXIsIHtcbiAgICAgICAgICAgICAgICBzaXRla2V5OiByZWNhcHRjaGFTaXRlS2V5LFxuICAgICAgICAgICAgICAgIGNhbGxiYWNrOiBoYW5kbGVSZWNhcHRjaGEsXG4gICAgICAgICAgICAgICAgJ2V4cGlyZWQtY2FsbGJhY2snOiBoYW5kbGVSZWNhcHRjaGEsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFF1ZXJ5IFRvRG8gc2VjdGlvbnMgJiBpbml0aWFsaXplIGdyZWF0IHRoaW5nc1xuICAgICAqL1xuICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgIGNvbnN0IHRvZG9TZWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoU0VMRUNUT1JfVE9ET1NfV1JBUFBFUik7XG4gICAgICAgIGlmICh0b2RvU2VjdGlvbnM/Lmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHRvZG9TZWN0aW9ucy5mb3JFYWNoKCh0b2RvU2VjdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICByZW5kZXJSZWNhcHRjaGEodG9kb1NlY3Rpb24sIGluZGV4KTtcbiAgICAgICAgICAgICAgICBzdWJzY3JpYmVGb3JtKHRvZG9TZWN0aW9uLCBpbmRleCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgaW5pdCk7XG59KShqUXVlcnkpO1xuIiwiZXhwb3J0IGRlZmF1bHQgKGZ1bmN0aW9uICgkKSB7XG5cbiAgICBmdW5jdGlvbiBDaGVja2JveGVzKCkge1xuICAgICAgICB0aGlzLmhhbmRsZUV2ZW50cygpO1xuICAgICAgICB0aGlzLmNvbnRlbnRUb2dnbGVFbmdpbmUoKTtcbiAgICB9XG5cbiAgICBDaGVja2JveGVzLnByb3RvdHlwZS5oYW5kbGVFdmVudHMgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAkKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl1bZGF0YS1tb2QtZ3VpZGUtcmVsYXRpb25dJykub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7XG5cbiAgICAgICAgICAgIGxldCByZWxhdGlvbnMgPSAkKHRoaXMpLmRhdGEoJ21vZC1ndWlkZS1yZWxhdGlvbicpO1xuICAgICAgICAgICAgcmVsYXRpb25zID0gcmVsYXRpb25zLnNwbGl0KCcsJyk7XG5cbiAgICAgICAgICAgICQuZWFjaChyZWxhdGlvbnMsIGZ1bmN0aW9uIChpbmRleCwgaXRlbSkge1xuICAgICAgICAgICAgICAgIGxldCAkY2IgPSAkKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl1bZGF0YS1tb2QtZ3VpZGUtdG9nZ2xlLWtleT1cIicgKyBpdGVtICsgJ1wiXScpO1xuICAgICAgICAgICAgICAgICRjYi5wcm9wKCdjaGVja2VkJywgISRjYi5wcm9wKCdjaGVja2VkJykpLnRyaWdnZXIoJ2NoYW5nZScpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgICQoJ1tkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5XScpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgdGhpcy5jb250ZW50VG9nZ2xlRW5naW5lKCk7XG4gICAgICAgIH0uYmluZCh0aGlzKSk7XG5cblxuICAgIH07XG5cbiAgICBDaGVja2JveGVzLnByb3RvdHlwZS5jb250ZW50VG9nZ2xlRW5naW5lID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIEdldCBjaGVja2VkIGNoZWNrYm94ZXNcbiAgICAgICAgbGV0IGNoZWNrZWQgPSBbXTtcbiAgICAgICAgbGV0ICRjaGVja2JveGVzID0gJCgnW2RhdGEtbW9kLWd1aWRlLXRvZ2dsZS1rZXldJyk7XG5cbiAgICAgICAgJGNoZWNrYm94ZXMuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmICgkKGVsZW1lbnQpLnByb3AoJ2NoZWNrZWQnKSAhPT0gdHJ1ZSkge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY2hlY2tlZC5wdXNoKCQoZWxlbWVudCkuYXR0cignZGF0YS1tb2QtZ3VpZGUtdG9nZ2xlLWtleScpKTtcblxuXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIERpc3BsYXkgb3IgaGlkZSBjb250ZW50XG4gICAgICAgICQoJ1tkYXRhLW1vZC1ndWlkZS10b2dnbGUta2V5LWNvbnRlbnRdJykuZWFjaChmdW5jdGlvbiAoaW5kZXgsIGVsZW1lbnQpIHtcbiAgICAgICAgICAgIGxldCBzaG91bGRTaG93ID0gZmFsc2U7XG4gICAgICAgICAgICBsZXQgY29uZGl0aW9ucyA9ICQoZWxlbWVudCkuYXR0cignZGF0YS1tb2QtZ3VpZGUtdG9nZ2xlLWtleS1jb250ZW50Jyk7XG4gICAgICAgICAgICBjb25kaXRpb25zID0gY29uZGl0aW9ucy5zcGxpdCgnLCcpO1xuXG4gICAgICAgICAgICAvLyBEYXRlcm1pbmQgaWYgY29udGVudCBzaG91bGQgYmUgc2hvd24gb3Igbm90XG4gICAgICAgICAgICAkLmVhY2goY29uZGl0aW9ucywgZnVuY3Rpb24gKGluZGV4LCBpdGVtKSB7XG4gICAgICAgICAgICAgICAgbGV0IGFuZCA9IGl0ZW0ubWF0Y2goLyhefFxcKykoW15cXCtcXC1dKykvZyk7XG4gICAgICAgICAgICAgICAgbGV0IGFuZFBhdHRlcm4gPSBuZXcgUmVnRXhwKCdcXFxcYignICsgYW5kLmpvaW4oJ3wnKS5yZXBsYWNlKCcrJywgJycpICsgJylcXFxcYicsICdpZycpO1xuICAgICAgICAgICAgICAgIGxldCBhbmRNYXRjaGVzID0gY2hlY2tlZC5qb2luKCcsJykubWF0Y2goYW5kUGF0dGVybik7XG4gICAgICAgICAgICAgICAgbGV0IGFuZElzTWF0Y2hpbmcgPSBhbmRNYXRjaGVzICE9PSBudWxsICYmIGFuZE1hdGNoZXMubGVuZ3RoID09PSBhbmQubGVuZ3RoO1xuXG4gICAgICAgICAgICAgICAgbGV0IGFuZG5vdCA9IGl0ZW0ubWF0Y2goL1xcLShbXlxcK1xcLV0rKS9nKTtcbiAgICAgICAgICAgICAgICBsZXQgYW5kbm90SXNNYXRjaGluZyA9IHRydWU7XG4gICAgICAgICAgICAgICAgaWYgKGFuZG5vdCAhPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICBsZXQgYW5kbm90UGF0dGVybiA9IG5ldyBSZWdFeHAoJ1xcXFxiKCcgKyBhbmRub3Quam9pbignfCcpLnJlcGxhY2UoJy0nLCAnJykgKyAnKVxcXFxiJywgJ2lnJyk7XG4gICAgICAgICAgICAgICAgICAgIGxldCBhbmRub3RNYXRjaGVzID0gY2hlY2tlZC5qb2luKCcsJykubWF0Y2goYW5kbm90UGF0dGVybik7XG4gICAgICAgICAgICAgICAgICAgIGFuZG5vdElzTWF0Y2hpbmcgPSAhKGFuZG5vdE1hdGNoZXMgIT09IG51bGwgJiYgYW5kbm90TWF0Y2hlcy5sZW5ndGggPiAwKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoYW5kSXNNYXRjaGluZyAmJiBhbmRub3RJc01hdGNoaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgIHNob3VsZFNob3cgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBIaWRlIG9yIHNob3dcbiAgICAgICAgICAgIGlmIChzaG91bGRTaG93ID09PSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgJChlbGVtZW50KS5zaG93KCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAkKGVsZW1lbnQpLmhpZGUoKTtcbiAgICAgICAgICAgIHJldHVybjtcblxuXG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICByZXR1cm4gbmV3IENoZWNrYm94ZXMoKTtcblxufSkoalF1ZXJ5KTtcbiIsImltcG9ydCAnLi9Db250ZW50L1RvZG8uanMnO1xuaW1wb3J0ICcuL0NvbnRlbnQvY2hlY2tib3hlcy5qcyc7XG5cbi8vIFJlcXVpcmVkIHNlbGVjdG9yc1xuY29uc3QgU0VMRUNUT1JfTU9EVUxBUklUWV9HVUlERSA9ICcuanMtbW9kdWxhcml0eS1ndWlkZSc7XG5jb25zdCBTRUxFQ1RPUl9TRUNUSU9OID0gJy5qcy1tb2R1bGFyaXR5LWd1aWRlX19zZWN0aW9uJztcbmNvbnN0IFNFTEVDVE9SX05FWFQgPSAnLmpzLW1vZHVsYXJpdHktZ3VpZGVfX25leHQnO1xuY29uc3QgU0VMRUNUT1JfUFJFViA9ICcuanMtbW9kdWxhcml0eS1ndWlkZV9fcHJldic7XG5jb25zdCBTRUxFQ1RPUl9BQ0NPUkRJT05fVE9HR0xFID0gJ1tqcy1leHBhbmQtYnV0dG9uXSc7XG5cbi8vIFJlcXVpcmVkIGRhdGEtYXR0cmlidXRlc1xuY29uc3QgQVRUUklCVVRFX1NURVAgPSAnZGF0YS1ndWlkZS1zdGVwJztcblxuLyoqXG4gKiBDbGljayBoYW5kbGVyIGZvciBOZXh0ICYgUHJldiBidXR0b25zLFxuICogd2lsbCB0cmF2ZXJzZSB1cCB0byBmaW5kIGN1cnJlbnQsIHByZXZpb3VzIGFuZCB0aGUgbmV4dCBzdGVwIHRvIHNpbXVsYXRlIGFjY29yZGlvbiBjbGlja1xuICogQHBhcmFtIHsqfSBlIGV2ZW50XG4gKi9cbmZ1bmN0aW9uIGhhbmRsZVByZXZOZXh0Q2xpY2soZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGNvbnN0IHByZXZOZXh0QnV0dG9uRWxlbWVudCA9IGUudGFyZ2V0O1xuICAgIGNvbnN0IGlzTmV4dCA9IGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhTRUxFQ1RPUl9ORVhULnN1YnN0cmluZygxKSk7XG5cbiAgICAvLyBUcmF2ZXJzZSBET00gdXB3YXJkc1xuICAgIGNvbnN0IGN1cnJlbnRHdWlkZSA9IHByZXZOZXh0QnV0dG9uRWxlbWVudD8uY2xvc2VzdChTRUxFQ1RPUl9NT0RVTEFSSVRZX0dVSURFKTtcbiAgICBjb25zdCBjdXJyZW50U2VjdGlvbiA9IHByZXZOZXh0QnV0dG9uRWxlbWVudD8uY2xvc2VzdChTRUxFQ1RPUl9TRUNUSU9OKTtcbiAgICBjb25zdCBjdXJyZW50U3RlcCA9IHBhcnNlSW50KGN1cnJlbnRTZWN0aW9uPy5nZXRBdHRyaWJ1dGUoQVRUUklCVVRFX1NURVApID8/ICctMScpO1xuXG4gICAgaWYgKGN1cnJlbnRTdGVwID4gMCkge1xuICAgICAgICBjb25zdCB0YXJnZXRTdGVwID0gaXNOZXh0ID8gY3VycmVudFN0ZXAgKyAxIDogY3VycmVudFN0ZXAgLSAxO1xuICAgICAgICBjb25zdCB0YXJnZXRTZWN0aW9uID0gY3VycmVudEd1aWRlPy5xdWVyeVNlbGVjdG9yKGBbJHtBVFRSSUJVVEVfU1RFUH09XCIke3RhcmdldFN0ZXB9XCJdYCk7XG4gICAgICAgIGNvbnN0IHRhcmdldFRvZ2dsZSA9IHRhcmdldFNlY3Rpb24/LnF1ZXJ5U2VsZWN0b3IoU0VMRUNUT1JfQUNDT1JESU9OX1RPR0dMRSk7XG5cbiAgICAgICAgaWYgKHRhcmdldFRvZ2dsZSkge1xuICAgICAgICAgICAgdGFyZ2V0VG9nZ2xlLmNsaWNrKCk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG4vKipcbiAqIFN1YnNjcmliZSBwcmV2L25leHQgYnV0dG9uIGNsaWNrIGV2ZW50XG4gKiBAcGFyYW0ge0VsZW1lbnR9IHdyYXBwZXJFbGVtZW50XG4gKi9cbmZ1bmN0aW9uIHN1YnNjcmliZVByZXZOZXh0QnV0dG9ucyh3cmFwcGVyRWxlbWVudCkge1xuICAgIGNvbnN0IGJ1dHRvbnMgPSBbXG4gICAgICAgIC4uLndyYXBwZXJFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYCR7U0VMRUNUT1JfU0VDVElPTn0gJHtTRUxFQ1RPUl9ORVhUfWApLFxuICAgICAgICAuLi53cmFwcGVyRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKGAke1NFTEVDVE9SX1NFQ1RJT059ICR7U0VMRUNUT1JfUFJFVn1gKSxcbiAgICBdO1xuXG4gICAgaWYgKGJ1dHRvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICBidXR0b25zLmZvckVhY2goYnV0dG9uRWxlbWVudCA9PiB7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgaGFuZGxlUHJldk5leHRDbGljayk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cblxuLyoqXG4gKiBRdWVyeSBndWlkZSBtb2R1bGVzICYgaW5pdGlhbGl6ZSBzdHVmZlxuICovXG5mdW5jdGlvbiBpbml0KCkge1xuICAgIGNvbnN0IGd1aWRlTW9kdWxlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoU0VMRUNUT1JfTU9EVUxBUklUWV9HVUlERSk7XG5cbiAgICBpZiAoZ3VpZGVNb2R1bGVzICYmIGd1aWRlTW9kdWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGd1aWRlTW9kdWxlcy5mb3JFYWNoKHN1YnNjcmliZVByZXZOZXh0QnV0dG9ucyk7XG4gICAgfVxufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGluaXQpOyJdLCJzb3VyY2VSb290IjoiIn0=